!function(a,b,c,d,e){"use strict";function f(a){return a.parent().children().index(a)}function g(a){var b=a.find("a");return b.length?b[0]:a[0]}function h(a){return e(a).closest(k)}var i="a-IconList",j="a-IconList-item",k="."+j,l="u-selector",m=l+" "+l+"--single",n="."+l,o="is-selected",p="."+o,q=p+k,r="is-focused",s="is-disabled",t="aria-selected",u="aria-multiselectable",v="aria-labelledby",w="role",x="tabindex",y="u-RTL",z=e.ui.keyCode,A=0,B=function(a,b){a._trigger("selectionChange",b)},C=d.debounce(B,1),D=d.debounce(B,350),E={begin:function(){this.text=""},item:function(a,b,c){b>0&&(this.text+="\r\n"),this.text+=c},end:function(){},toString:function(){return this.text}},F={begin:function(){this.text="<ul>\r\n"},item:function(a,b,c){this.text+="<li>"+d.escapeHTML(c)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};e.widget("apex.iconList",e.extend(!0,{version:"19.1",widgetEventPrefix:"iconlist",options:{multiple:!1,itemSelector:!1,addItemSelector:!0,label:!0,navigation:!1,tabbableContent:null,noNavKeyContent:null,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create(E)},{format:"text/html",writer:Object.create(F)}],selectionChange:null,activate:null},_create:function(){var a,c=this,d=this.options,f=this.element;this.columns=0,this.rows=0,this.searchString="",this.searchTimerId=null,d.navigation&&(d.multiple=!1),f.addClass(i).attr(w,"listbox"),d.multiple&&f.attr(u,"true"),this.forwardKey=z.RIGHT,this.backwardKey=z.LEFT,"rtl"===f.css("direction")&&(f.addClass(y),this.forwardKey=z.LEFT,this.backwardKey=z.RIGHT),f.attr(v)?(a=e("#"+f.attr(v).split(" ").join(",#")).last(),this.infoId=a.attr("id")+"_info",a.append("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>")):(this.infoId=(f.attr("id")||"il"+A++)+"_info",f.before("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>"),f.attr(v,this.infoId),this.addedLabel=!0),this._initContextMenu(j,function(a){return!1},function(a){var b="keydown"===a.type&&c.lastFocused?c.lastFocused:a.target,d=h(b);return!!d.length&&(!!d.hasClass(o)||d)}),this._on(this._eventHandlers),d.allowCopy&&b.addHandler(f[0],function(a){return c._copy(a),!0}),this.refresh(),d.disabled&&this._setOption("disabled",d.disabled)},_eventHandlers:{resize:function(a){a.target===this.element[0]&&(this._dim(),a.stopPropagation())},click:function(a){var b,c=this.options,d=c.navigation,f=e(a.target);d&&f.closest("a").length>0&&(a.shiftKey||a.ctrlKey)||(b=f.closest(k),b.length&&(c.itemSelector&&f.closest(n).length&&(a.ctrlKey=!0,a.shiftKey=!1),this._select(b,a,!0,!1),d&&this._activate(a),!d&&c.tabbableContent&&f.closest(c.tabbableContent).length?c.tabbableContent&&f.closest(c.tabbableContent).length&&f.focus():a.preventDefault()))},dblclick:function(a){var b;this.options.navigation||(b=h(a.target),b.length&&this._activate(a))},mousedown:function(a){a.preventDefault()},keydown:function(a){var b,c,d,g=this.element,i=this.options,j=e(a.target),k=null,l=a.which;!i.navigation&&i.noNavKeyContent&&j.closest(i.noNavKeyContent).length||(l===z.HOME?k=g.children().first():l===z.END?k=g.children().last():l===z.DOWN?this.lastFocused&&(b=this._index2RowCol(f(h(this.lastFocused))),c=g.children(),b.row<Math.floor((c.length-1)/this.columns)&&(d=this._rowCol2Index(b.row+1,b.column),d>=c.length&&(d=c.length-1),k=c.eq(d))):l===z.UP?this.lastFocused&&(b=this._index2RowCol(f(h(this.lastFocused))),c=g.children(),d=this._rowCol2Index(b.row-1,b.column),d>=0&&(k=c.eq(d)),k&&a.stopPropagation()):l===this.backwardKey?this.lastFocused&&(k=h(this.lastFocused).prev()):l===this.forwardKey?this.lastFocused&&(k=h(this.lastFocused).next()):l===z.SPACE?this.lastFocused&&!this.searchTimerId&&(k=h(this.lastFocused)):l===z.ENTER&&"A"!==a.target.nodeName&&this._activate(a),k&&k[0]&&(this._select(k,a,!0,!0),a.preventDefault()))},keypress:function(a){var b,c,d=this.options,f=this;if(0!==a.which&&d.label&&!a.altKey&&!a.ctrlKey&&(d.navigation||!d.noNavKeyContent||!e(a.target).closest(d.noNavKeyContent).length)){if(b=String.fromCharCode(a.which).toLowerCase(),this.searchTimerId)b!==this.searchString&&(this.searchString+=b),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===b)return;this.searchString=b}this.searchTimerId=setTimeout(function(){f.searchTimerId=null},500),c=this._findItem(this.searchString),c&&this._select(c,a,!0,!0)}},focusin:function(a){var b=h(a.target);0!==b.length&&(b.addClass(r),this._setFocusable(a.target))},focusout:function(a){var b=h(a.target);b.removeClass(r)}},_destroy:function(){var a=this.element,c=this.options;a.removeClass(i+" "+s+" "+y).removeAttr(w).removeAttr(u).children().removeClass(j).removeAttr(w).removeAttr(t).removeAttr(x),a.find("a").removeAttr(x).removeAttr(w),c.itemSelector&&c.addItemSelector&&a.find(n).remove(),b.removeHandler(a[0]),this._destroyContextMenu(),e("#"+this.infoId).remove(),this.addedLabel&&a.removeAttr(v)},_setOption:function(a,b){var c,d,e=this.options,f=this.element;if(this._checkContextMenuOptions(a,b),"multiple"===a)e.navigation&&(b=!1);else if("allowCopy"===a||"addItemSelector"===a||"navigation"===a)throw new Error("IconList "+a+" option cannot be set");this._super(a,b),"disabled"===a?(f.toggleClass(s+" ui-state-disabled",b).attr("aria-disabled",b),this.lastFocused&&(b?this.lastFocused&&(c=!e.navigation&&e.tabbableContent,c?(d=h(this.lastFocused),d.add(d.find(c).not(":disabled")).prop("tabIndex",-1)):this.lastFocused.tabIndex=-1):this._setFocusable(this.lastFocused)),b&&this._dim()):"multiple"===a?b?f.attr(u,"true"):f.removeAttr(u):"itemSelector"===a&&this.refresh()},refresh:function(){var a,b,c,d=this.options,f=this.element;d.multiple&&!d.itemSelector&&apex.userHasTouched()&&(d.itemSelector=!0,d.addItemSelector=!0),f.find("a").attr(x,-1).attr(w,"option"),f.find(d.tabbableContent).attr(x,-1),c=f.children(),c.addClass(j).filter(function(){return 0===e(this).find("a").length}).attr(w,"option").attr(x,-1),d.addItemSelector&&(d.itemSelector?(b=e("<span class='"+(d.multiple?l:m)+"'></span>"),c.filter(function(){return e(this).find(n).length<=0}).prepend(b)):f.find(n).remove()),this._dim(),a=f.find(q),a.length>0?this.setSelection(a,!1):(this.lastFocused&&e(this.lastFocused).is(":visible")||(this.lastFocused=g(f.children().first())),this.selectAnchor=this.lastFocused,this.lastFocused&&!d.disabled&&this._setFocusable(this.lastFocused))},resize:function(){this._dim()},focus:function(){this.lastFocused&&this.lastFocused.focus()},getColumns:function(){return this.columns},getRows:function(){return this.rows},getSelection:function(){return this.element.find(q)},getSelectionValues:function(){var a=[];return this.getSelection().each(function(){a.push(e(this).attr("data-value"))}),a},setSelection:function(a,b,c){b=!!b,this._select(a,null,b,!1,c)},_copy:function(a){var b,c,d=this.getSelection(),e=this.options.dataTransferFormats;if(d.length){for(e.forEach(function(a){a.writer.begin(d)}),b=0;b<d.length;b++)c=d.eq(b),e.forEach(function(a){a.writer.item(c,b,c.text())});e.forEach(function(b){b.writer.end(),a.setData(b.format,b.writer.toString())})}},_rowCol2Index:function(a,b){return a*this.columns+b},_index2RowCol:function(a){var b=Math.floor(a/this.columns);return{row:Math.floor(a/this.columns),column:a-b*this.columns}},_dim:function(){var a,b,d,f=this,g=this.element,h=g.width(),i=g.children(),j=i.length;j&&(a=i.first().position().top,d=i.first().outerWidth()),this.columns=j,i.each(function(b){var c=e(this).position().top;if(c>a)return a=c,f.columns=b,!1}),j>0?this.rows=Math.floor((j+this.columns-1)/this.columns):this.rows=0,1===this.rows&&(this.columns=Math.floor(h/d)),b=1===this.columns?c.formatMessage("APEX.ICON_LIST.LIST_DIM",this.rows):c.formatMessage("APEX.ICON_LIST.GRID_DIM",this.columns,this.rows),e("#"+this.infoId).text(b)},_findItem:function(a){var b,c,d,e=this.element,f=a.length,g=this.options.label;for(c=d=h(this.lastFocused),1===f&&(c=c.next()),0===c.length&&(c=e.children().first());c.length>0;){if(b=g===!0?c.text().trim():c.find(g).text(),b.substring(0,f).toLowerCase()===a)return c;if(c=c.next(),0===c.length&&(c=e.children().first()),c[0]===d[0])break}return null},_setFocusable:function(a){var b,c,d=this.options,e=!d.navigation&&d.tabbableContent;this.lastFocused&&this.lastFocused!==a&&(e?(c=h(this.lastFocused),c.add(c.find(e).not(":disabled")).prop("tabIndex",-1)):this.lastFocused.tabIndex=-1),e?(c=h(a),b=c.find(e).not("disabled").prop("tabIndex",0).length,b||c.prop("tabIndex",0)):a.tabIndex=0,this.lastFocused=a},_activate:function(a){var b,c;this._trigger("activate",a,{values:this.getSelectionValues()}),this.options.navigation&&!a.isDefaultPrevented()&&(b=this.getSelection(),c=b.attr("href")||b.find("a").attr("href"),c&&(a.preventDefault(),apex.navigation.redirect(c)))},_select:function(a,b,c,h,i){var j,k,l,m,p,r,s,u,v,w="set",x=this,y=this.element,z=this.options,A=y.find(q);a=a.filter(":visible"),b&&z.multiple&&("click"===b.type?b.ctrlKey||b.metaKey?w="toggle":b.shiftKey&&(w="range"):"keydown"===b.type&&(b.keyCode===e.ui.keyCode.SPACE?w=b.ctrlKey?"toggle":b.shiftKey?"range":"add":b.ctrlKey?w="none":b.shiftKey&&(w="range"))),"range"!==w||this.selectAnchor||(w="set"),"set"!==w&&"range"!==w||A.removeClass(o).removeAttr(t).find(n).removeClass(o),j=a.hasClass(o),"set"===w||"add"===w||"toggle"===w&&!j?(a.addClass(o).attr(t,!0).find(n).addClass(o),this.selectAnchor=a[0]):"range"===w?(y.children().removeClass(o).removeAttr(t).find(n).removeClass(o),r=f(e(this.selectAnchor)),s=f(a.last()),r>s&&(u=s,s=r,r=u),y.children().filter(function(a){return a>=r&&a<=s}).addClass(o).attr(t,!0).find(n).addClass(o)):"toggle"===w&&j&&(a.removeClass(o).removeAttr(t).find(n).removeClass(o),this.selectAnchor=a[0]),a.length>0&&(v=g(a.first()),c?(v.tabIndex=0,v.focus()):this._setFocusable(v),l=y.scrollParent(),m=l[0]===document?{left:0,top:0}:l.offset(),m&&(p=y.offset(),k=a.first().offset(),(k.top<m.top||k.top>m.top+l[0].offsetHeight)&&(l[0].scrollTop=k.top-p.top),(k.left+a[0].offsetWidth<m.left||k.left>m.left+l[0].offsetWidth)&&(l[0].scrollLeft=k.left-p.left))),i||z.navigation&&b&&"click"===b.type||("toggle"===w||"range"===w&&!j||"add"===w&&!j||"set"===w&&!d.arrayEqual(A,a))&&(h?D(x,b):C(x,b))}},apex.widget.contextMenuMixin))}(apex.debug,apex.clipboard,apex.lang,apex.util,apex.jQuery);
!function(a,b,c,d,e,f,g,h){"use strict";function i(a,b){var c="";return"start"===a?c=" u-tS":"end"===a?c=" u-tE":"left"===a?c=" u-tL":"right"===a?c=" u-tR":"center"!==a||b||(c=" u-tC"),c}function j(a,b,c){var d;return a.highlight&&(d=b.highlights[a.highlight],c+=d&&d.cssClass?" "+d.cssClass:" "+a.highlight),c}function k(a,b,c,d,e){var f=N;return a.agg?(f+=" "+Ka,f+=" a-GV-aggregate--"+a.agg,a.grandTotal&&(f+=" is-grandTotal")):((a.sel||c)&&(f+=" "+xa),a.deleted?f+=" "+Ha:(a.inserted?f+=" is-inserted":a.updated&&(f+=" is-updated"),a.error?f+=" is-error":a.warning&&(f+=" is-warning"),f=j(a,b,f),d.allowEdit(e)||(f+=" "+Ia))),f}function l(a,b,c,d,e,f,g){var h=!1,k=S;return k+=i(a.alignment),a.columnCssClasses&&(k+=" "+a.columnCssClasses),a.cellCssClassesColumn&&(k+=" "+f.getValue(g,a.cellCssClassesColumn)),e&&(e.hasClass(xa)&&(k+=" "+xa),e.hasClass(za)&&(k+=" "+za),e.hasClass(Ea)&&(k+=" "+Ea)),c&&(b.deleted||(c.error?k+=" is-error":c.warning?k+=" is-warning":c.changed&&(k+=" is-changed")),k=j(c,d,k),c.disabled&&(k+=" is-disabled"),h=c.ck),(h||a.readonly)&&(k+=" "+Ia),a.usedAsRowHeader&&!b.agg&&(k+=" "+ba),k}function m(a){return d.getMessage("APEX.GV."+a)}function n(a){var b=Array.prototype.slice.call(arguments);return b[0]="APEX.GV."+a,d.formatMessage.apply(d,b)}function o(a,b,c){for(var d,e,f=0,g=a.length-1;f<=g;)if(d=g+f>>1,e=c(b,a[d]),e>0)f=d+1;else{if(!(e<0))return d;g=d-1}return f}function p(a,b){return a.offset-b.offset}function q(a){return a.parent().children().index(a)}function r(a){var b=h(a.toString());return b.find("a,button,input,select,textarea").prop(tb,-1),b}function s(a){return h(a).closest(ia)}function t(a){return h(a).closest(na)}function u(a){return h(a).closest(T)}function v(a,b){var c,d,e=a.children();return e.last().hasClass(X)?(d=0,e.each(function(){if(d+=parseInt(h(this).attr(pb),10)||1,d>b)return c=h(this),!1})):c=e.eq(b),c}function w(a){var b;return a.hasClass(X)?(b=0,a.parent().children().each(function(){return this!==a[0]&&void(b+=parseInt(h(this).attr(pb),10)||1)})):b=q(a),b}function x(a){h(nb).on(Bb,function(b){b.which===vb.ESCAPE&&(h(nb).off(Bb),a())})}function y(){h(nb).off(Bb)}function z(a){var b=a.groupName||null;return b&&a.useGroupFor&&a.useGroupFor.indexOf("heading")<0&&(b=null),b}function A(a,b){var c=a.parent()[0],d={h:!1,v:!1};return a.outerHeight()+(b||parseInt(a.css("margin-top"),10))>c.clientHeight&&(d.v=!0),a.outerWidth()>c.clientWidth&&(d.h=!0),d}var B="a-GV",C="a-GV-hdr",D="."+C,E="a-GV-bdy",F="."+E,G="a-GV-w-frozen",H="."+G,I="a-GV-w-hdr",J="."+I,K="a-GV-w-scroll",L="."+K,M="a-GV-table",N="a-GV-row",O="."+N,P="."+M,Q="tr",R="td,th",S="a-GV-cell",T="."+S,U="a-GV-scrollFiller",V="a-GV-header",W="."+V,X="a-GV-headerGroup",Y="."+X,Z="a-GV-headerLabel",$="a-GV-columnControls",_="."+$,aa="a-GV-columnHandle",ba="a-GV-rowHeader",ca="u-selector",da=ca+" "+ca+"--single",ea="."+ca,fa="a-GV-selHeader",ga="."+fa,ha=ga+W,ia=".a-GV-header,.a-GV-headerGroup,.a-GV-cell,.a-GV-controlBreakHeader",ja=".a-GV-header,.a-GV-headerGroup",ka="a-GV-controlBreak",la="a-GV-controlBreakHeader",ma="."+la,na="."+S+",."+la,oa="js-tabTrap",pa="."+oa,qa="js-autoAdd",ra=".a-GV-floatingItem",sa="a-GV-floatingItemContent",ta="."+sa,ua="a-GV-expandCollapse",va="."+ua,wa=".a-GV-loadMoreButton",xa="is-selected",ya="."+xa,za="is-focused",Aa="is-hover",Ba="."+Aa,Ca="is-disabled",Da="is-expanded",Ea="is-active",Fa="."+Ea,Ga=Fa+T,Ha="is-deleted",Ia="is-readonly",Ja="tr."+Ha,Ka="is-aggregate",La="aria-selected",Ma="aria-multiselectable",Na="aria-readonly",Oa="aria-label",Pa="aria-expanded",Qa="aria-labelledby",Ra="aria-checked",Sa="u-RTL",Ta=":visible",Ua=":tabbable",Va=":disabled,.js-asc,.js-desc",Wa="none",Xa="sequence",Ya="label",Za="true",$a="false",_a="selectionChange",ab="modeChange",bb="sortChange",cb="columnReorder",db="columnResize",eb="activateColumnHeader",fb="cancelColumnHeader",gb="pageChange",hb="activateCell",ib=10,jb=40,kb=200,lb=10,mb=10,nb="body",ob="title",pb="colspan",qb="data-idx",rb="data-id",sb="data-rownum",tb="tabIndex",ub="tabindex",vb=h.ui.keyCode,wb=0,xb=a.invokeAfterPaint,yb="wheel";"onwheel"in document.body||(yb=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll");var zb={begin:function(){this.text=""},beginRow:function(a){a>0&&(this.text+="\r\n")},cell:function(a,b,c,d){a>0&&(this.text+="\t"),this.text+=d},endRow:function(){},end:function(){},toString:function(){return this.text}},Ab={begin:function(a,b,c){return 1===c.length&&b.records&&1===b.records.length?void(this.text=""):(this.table=!0,void(this.text="<table><tbody>"))},beginRow:function(){this.table&&(this.text+="<tr>")},cell:function(b,c,d,e){this.table?this.text+="<td>"+a.escapeHTML(e)+"</td>":this.text+=a.escapeHTML(e)},endRow:function(){this.table&&(this.text+="</tr>")},end:function(){this.table&&(this.text+="</tbody></table>")},toString:function(){return this.text}},Bb="keydown.gridGlobalEscape",Cb=function(a,b,c){a.element.hasClass(B)&&(a._updateStatus(),b&&a._trigger(_a,c))},Db=a.debounce(Cb,1),Eb=a.debounce(Cb,350);h.widget("apex.grid",h.apex.tableModelViewBase,h.extend(!0,{version:"19.1",widgetEventPrefix:"grid",options:{showNullAs:"-",stickyTop:!1,columns:null,columnGroups:null,columnSort:!0,columnSortMultiple:!0,resizeColumns:!0,reorderColumns:!0,collapsibleControlBreaks:!0,aggregateLabels:{},aggregateTooltips:{},tabbableCellContent:"a,button",allowEditMode:!0,allowDelete:!0,allowInsert:!0,allowCopy:!0,skipReadonlyCells:!1,rowHeader:Wa,rowHeaderCheckbox:!1,rowHeaderLabelColumn:null,rowHeaderWidth:null,selectCells:!1,multiple:!1,multipleCells:!0,selectAll:!0,allowSelectHidden:!1,persistSelection:!1,tooltip:{tooltipClass:"a-GV-tooltip"},dataTransferFormats:[{format:"text/plain",writer:Object.create(zb)},{format:"text/html",writer:Object.create(Ab)}],constrainNavigation:!0,selectionChange:null,activateColumnHeader:null,activateCell:null,cancelColumnHeader:null,sortChange:null,columnReorder:null,columnResize:null,modeChange:null,pageChange:null},_create:function(){var a=this,b=this.options,d=this.element;c.info("Grid '"+d[0].id+"' created. Model: "+b.modelName),d.addClass(B).attr("role","grid"),b.multiple&&d.attr(Ma,Za),b.editable||d.attr(Na,Za),this.forwardKey=vb.RIGHT,this.backwardKey=vb.LEFT,"rtl"===d.css("direction")&&(d.addClass(Sa),this.forwardKey=vb.LEFT,this.backwardKey=vb.RIGHT),this._enforceOptionConstraints(),this._super(),this.origLabelBy=d.attr(Qa),this.idPrefix=d[0].id||"agv_"+wb++,this.accContextId=this.idPrefix+"_ctx",this.curRowHeaders="",this.tableFrozenHeader$=null,this.tableHeader$=null,this.tableFrozenData$=null,this.tableData$=null,this.lastEditModeCell=null,this.frozenColumnCount=0,this.controlBreaks=[],this.editMode=!1,this.columns=null,this.columnsStale=!0,this.columnGroups=null,this.lastFrozenColIndex=-1,this.lastFocused=null,this.lastRow$=null,this.focusInHeader=!1,this.lastHoverCell=null,this.lastHoverRow=null,this.lastColIndex=null,this.columnControls$=null,this.scrollTimerId=null,this.deactivateDelayTimer=null,this.lastFloatingPos={},this.allSelected=!1,this.gotoCellPending=null,this._initContextMenu(Q,function(b){return h(b.target).closest("a").length>0||a.editMode},function(b){var c;if(c=u("keydown"===b.type?this.lastFocused:b.target),c.length){if(a.options.selectCells){if(!c.hasClass(xa))return c}else if(!c.parent().hasClass(xa))return c;return!0}return!1},function(b){a.options.selectCells?b.selectedRange=a.getSelectedRange():b.selectedRecords=a.getRecords(b.selection)}),this._initModel(b.modelName),this._on(this._eventHandlers),b.allowCopy&&f.addHandler(d[0],function(b){return!a.editMode&&(a._copy(b),!0)}),this._updateHighlights(),this.refresh(),this._setSelectionMode(),b.disabled&&this._setOption("disabled",b.disabled)},_eventHandlers:{resize:function(a){a.target===this.element[0]&&(this.resize(),a.stopPropagation())},click:function(a){var b,c,d=this.options,e=h(a.target);if(e.closest("a,button,.a-GV-footer").length)return b=e.closest(ja),void(b.length?(this.focusInHeader=!0,this.lastColIndex=null,this._select(b,a,!0,!1)):(b=e.closest(na),b.length&&!this.editMode&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(b,"none",!1,!1),e.focus())));if(!(e.closest(ra).length>0)){if(b=e.closest(ha),b.length)return this.focusInHeader=!0,this.lastColIndex=null,void(d.rowHeaderCheckbox&&d.multiple&&d.selectAll&&!d.selectCells?(c=b.find(ea).attr(Ra)===Za,c?this.setSelection(h()):this.selectAll(),this._select(b,a,!0,!1),this._setFocusable(b[0])):this._select(b,a,!0,!1));if(b=e.closest(Y),b.length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(b,a,!0,!1),void a.preventDefault();if(b=e.closest(W),b.length&&0===e.closest("button").length)return this.focusInHeader=!0,this.lastColIndex=null,this._select(b,a,!0,!1),this._activateColumnHeader(a,b),void a.preventDefault();if(b=e.closest(ga),b.length)return d.rowHeaderCheckbox&&!d.selectCells&&(a.ctrlKey=!0,a.shiftKey=!1),this.focusInHeader=!1,this.lastColIndex=null,this._select(b,a,!0,!1),void a.preventDefault();b=e.closest(T),b.length&&(this.focusInHeader=!1,this.lastColIndex=null,b.hasClass(Ea)||(this._select(b,a,!0,!1),a.preventDefault())),b=e.closest(ma),b.length&&(this.focusInHeader=!1,this.lastColIndex=null,this._select(b,a,!0,!1),a.preventDefault())}},dblclick:function(a){var b=this.options,c=h(a.target).closest(T).not(ga);c.length&&(b.editable&&b.allowEditMode?this.editMode||this.setEditMode(!0):this._fireActivate(a,c))},mousedown:function(a){var b=h(a.target);return 0!==a.originalEvent.button||b.closest("a,button,.a-GV-footer").length?void(this.focusInHeader=b.closest(ja).length>0):void(!b.closest(va).length&&this.editMode||a.preventDefault())},keydown:function(a){function b(){f.hasClass(fa)?f.find(ea).click():(n._activateColumnHeader(a,f),a.preventDefault())}function c(a,b){var c,d=null;for(a+=b,c=a;c>=0&&c<n.columns.length;c+=b)if(!n.columns[c].hidden){d=c;break}return d}var d,e,f,g,i,j,k,l,m,n=this,o=this.options,p=null,r=a.which,v=h(a.target);if(!(v.closest(".a-GV-footer").length>0)){if(r!==vb.PAGE_UP&&r!==vb.PAGE_DOWN||(j=this.displayPageSize),r===vb.HOME)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.first(),a.preventDefault());else if(r===vb.END)!this.editMode&&this.lastFocused&&(this.lastColIndex=null,p=this.lastRow$.last(),a.preventDefault());else if(r===vb.PAGE_DOWN)this.focusInHeader||this.editMode&&!s(this.lastFocused).hasClass(fa)||a.altKey||(p=this._getNextCellDown(t(this.lastFocused),j),!p&&o.pagination.loadMore&&this.element.find(".js-load").focus(),a.preventDefault());else if(r===vb.PAGE_UP)this.focusInHeader||this.editMode&&!s(this.lastFocused).hasClass(fa)||a.altKey||(p=this._getPrevCellUp(t(this.lastFocused),j,!0),a.preventDefault());else if(r===vb.DOWN){if(f=s(this.lastFocused),o.columnSort&&a.altKey&&f.hasClass(V))return void n._sortChange(a,f,"desc");(!this.editMode||this.focusInHeader||f.hasClass(fa)||f.hasClass(la))&&this.lastFocused&&!a.altKey&&(p=this._getNextCellDown(f,1),!p&&o.pagination.loadMore&&this.element.find(".js-load").focus()[0]&&a.preventDefault(),(p||o.constrainNavigation)&&a.preventDefault()),v.closest(".js-menuButton").length&&a.stopPropagation()}else if(r===vb.UP){if(f=s(this.lastFocused),o.columnSort&&a.altKey&&f.hasClass(V))return void n._sortChange(a,f,"asc");(!this.editMode||this.focusInHeader||f.hasClass(fa)||f.hasClass(la))&&this.lastFocused&&!a.altKey&&(v.hasClass("js-load")?(this.focus(),a.preventDefault()):p=this._getPrevCellUp(f,1),(p||o.constrainNavigation)&&a.preventDefault(),a.stopPropagation())}else if(r===this.backwardKey){if(a.altKey)return;if(f=s(this.lastFocused),(a.ctrlKey||a.shiftKey)&&(f.hasClass(V)||f.hasClass(X))&&(!f.hasClass(fa)||o.rowHeader===Xa||o.rowHeader===Ya)&&(i=parseInt(f.attr(qb),10),!isNaN(i)||a.ctrlKey||o.rowHeader===Xa||o.rowHeader===Ya))if(i>=0&&(g=this.columns[i]),a.shiftKey&&o.reorderColumns){if(a.preventDefault(),f.hasClass(X))k=q(f.parent()),i>0&&(this.moveColumnGroup(k,i,i-1),f=h(this.lastFocused).closest(Y));else if(i=c(i,-1))return void this.moveColumn(g,i)}else if(a.ctrlKey&&o.resizeColumns&&!f.hasClass(X))return void(g?f.outerWidth()>jb&&(m=f.outerWidth()-ib,m<jb&&(m=jb),this.setColumnWidth(g,m)):n.rowHeaderWidth>jb&&(m=n.rowHeaderWidth-ib,m<jb&&(m=jb),n.rowHeaderWidth=m,this._calculateColumnWidths(f,!0)));(!this.editMode||this.focusInHeader||f.hasClass(la))&&this.lastFocused&&(this.lastColIndex=null,e=this.lastRow$.index(f),e>0&&(e-=1,p=this.lastRow$.eq(e)),a.preventDefault())}else if(r===this.forwardKey){if(a.altKey)return;if(f=s(this.lastFocused),(a.ctrlKey||a.shiftKey)&&(f.hasClass(V)||f.hasClass(X))&&(!f.hasClass(fa)||o.rowHeader===Xa||o.rowHeader===Ya)&&(i=parseInt(f.attr(qb),10),!isNaN(i)||a.ctrlKey||o.rowHeader===Xa||o.rowHeader===Ya))if(i>=0&&(g=this.columns[i]),a.shiftKey&&o.reorderColumns){if(a.preventDefault(),f.hasClass(X))k=q(f.parent()),i<this.columnGroups[k].length-1&&(this.moveColumnGroup(k,i,i+1),f=h(this.lastFocused).closest(Y));else if(i=c(i,1))return void this.moveColumn(g,i)}else if(a.ctrlKey&&o.resizeColumns&&!f.hasClass(X))return void(g?this.setColumnWidth(g,f.outerWidth()+ib):(n.rowHeaderWidth+=ib,this._calculateColumnWidths(f,!0)));(!this.editMode||this.focusInHeader||f.hasClass(la))&&this.lastFocused&&(this.lastColIndex=null,e=this.lastRow$.index(f),e<this.lastRow$.length-1&&(e+=1,p=this.lastRow$.eq(e)),a.preventDefault())}else if(65===r&&a.ctrlKey&&!this.editMode)this.selectAll(null),a.preventDefault();else if(r===vb.SPACE){if("BUTTON"===a.target.nodeName)return;if(f=v.filter(ga).find(ea),f.length)return f.click(),void a.preventDefault();f=s(this.lastFocused),f.hasClass(V)?b():!f.hasClass(S)||this.editMode&&!f.hasClass(fa)||(this._select(f,a,!0,!0),a.preventDefault())}else if(r===vb.ENTER){if(!v.hasClass(ua)&&v.closest("a,button,.js-uses-enter").length>0)return;if(f=v.filter(ga).find(ea),f.length)return void f.click();f=s(this.lastFocused),this.editMode&&(f.hasClass(S)||f.hasClass(la))?a.shiftKey?(p=this._getPrevCellUp(f,1,!0),a.shiftKey=!1):p=this._getNextCellDown(f,1):(a.preventDefault(),o.editable&&o.allowEditMode&&f.hasClass(S)&&!f.hasClass(fa)?this.setEditMode(!0):f.hasClass(V)?b():o.editable&&o.allowEditMode||!f.hasClass(S)||this._fireActivate(a,f))}else if(113===r)f=u(this.lastFocused),f.length&&o.editable&&o.allowEditMode&&!this.editMode&&this.setEditMode(!0);else if(r===vb.ESCAPE)o.editable&&o.allowEditMode&&this.editMode&&this._doEscapeKey(a);else if(r===vb.DELETE){if(o.editable&&o.allowDelete&&!this.editMode&&!this.focusInHeader){for(l=this.getSelectedRecords(),d=0;d<l.length;d++)this.model.allowDelete(l[d])||(l.splice(d,1),d-=1);l.length>0&&this.model.deleteRecords(l)}}else 45===r?o.editable&&o.allowInsert&&!this.editMode&&!o.selectCells&&this.model.allowAdd()&&(l=this.getSelectedRecords(),l.length>0?this.model.insertNewRecord(null,l[l.length-1]):this.model.insertNewRecord()):112===r&&a.altKey?this._doHelpKey():r===vb.TAB&&this.editMode&&(this.lastKeyTab=!0);p&&(this._select(p,a,!0,!0),a.preventDefault())}},focusin:function(a){var b,c,d=null,e=this,f=h(a.target);return f.closest(ra).length?void this._clearDeactivate():(b=f.closest(ia),0===b.length?void(f.hasClass(oa)||(this.lastEditModeCell=null)):(b.addClass(za),this.lastEditModeCell===b[0]?void this._clearDeactivate():(this.editMode?(this.focusInHeader=!1,c=h(this.lastEditModeCell),this._clearDeactivate(),c.length&&this._deactivateCell(c),b.hasClass(S)||b.hasClass(la)?!b.hasClass(fa)&&!b.hasClass(la)||this.lastKeyTab?(f.closest("a,button").length&&(d=a.target),setTimeout(function(){e.editMode&&!b.hasClass(Ea)&&e._activateCell(b,d)},1)):(this._clearTabTraps(),this.lastEditModeCell=null,this._setFocusable(a.target),this._setTabTraps(b)):(this.focusInHeader=!0,this.lastEditModeCell=null,this._setFocusable(a.target))):this._setFocusable(a.target),void(this.lastKeyTab=!1))))},focusout:function(a){var b=h(a.target),c=b.closest(ia);c.removeClass(za),this.editMode&&c.hasClass(S)&&(null===this.lastEditModeCell&&this._clearTabTraps(),this._beginDeactivate(c))},mousemove:function(a){var b,c,d,e,f,g=h(a.target),i=this.options,j=g.closest(ia);j.length?j[0]!==this.lastHoverCell&&(b=j.parent(),b[0]!==this.lastHoverRow&&(this._clearHoverStates(),this.lastHoverRow=b[0],!b.hasClass(N)&&!b.hasClass(ka)||this.columnReordering||this.columnWidthDragging||this._setRowHoverState(b)),this.lastHoverCell=j[0],this.columnControls$.hide(),this.columnHandle$.hide(),"TH"!==j[0].nodeName||j.hasClass(S)||b.hasClass(ka)||(e=this.columns[j.attr(qb)],!i.columnSort||this.columnReordering||this.columnWidthDragging||j.hasClass(fa)||j.hasClass(X)||!e.canSort||(j.append(this.columnControls$.show()),this._updateColumnControls(e)),!i.reorderColumns||this.columnReordering||this.columnWidthDragging||j.hasClass(fa)||(this.columnReorderCell$=j,j.append(this.columnHandle$.show().css("left",""))),!i.resizeColumns||this.columnReordering||this.columnWidthDragging||j.hasClass(fa)&&i.rowHeader!==Xa&&i.rowHeader!==Ya||(c=j.closest("div")[0],d=j[0].offsetLeft+c.offsetLeft-c.scrollLeft,this.element.hasClass(Sa)||(d+=j.outerWidth()),this.columnWidthHandle$.show().css("left",d-this.columnWidthHandle$.width()/2),f=j.attr(qb),f?this.columnWidthCell$=this._columnFromIndex(f):this.columnWidthCell$=this.element.find(W+ga)))):null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())},mouseleave:function(){null!==this.lastHoverCell&&(this.lastHoverCell=null,this.lastHoverRow=null,this._clearHoverStates())}},_doEscapeKey:function(a){var b=u(this.lastFocused);b.length&&this._setFocusable(b[0]),b.focus(),this.setEditMode(!1),b.length&&this._setFocus(this._getCellFocusable(b)),a.stopPropagation()},_doHelpKey:function(){var a,b=s(this.lastFocused);b.hasClass(fa)||b.hasClass(X)||b.hasClass(la)||(a=this._getColumnMetadata(b),a&&a.helpid&&(this.editMode&&b.focus(),apex.theme.popupFieldHelp(a.helpid,$v("pInstance"))))},_initTooltips:function(b){var d,e=this;return h.ui.tooltip?(this.tooltipOptions&&(this.element.find(F).filter(":data('ui-tooltip')").tooltip("destroy"),this.tooltipOptions=null),void(b&&(d=this.tooltipOptions=h.extend(!0,{show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip"},b),d.items=R,d._originalContent=d.content,d.content=function(b){var c,f,g,i=h(this),j=i.parent(),k=null,l=null,m=e._getColumnMetadata(i);if(c=j.attr(rb),c&&(k=e.model.getRecordMetadata(c)),m&&k&&k.fields&&(l=k.fields[m.property]),k&&!k.deleted){if(l&&(l.error||l.warning))return f=l.error?"is-error":"is-warning","<span class='"+f+"'>"+a.escapeHTML(l.message)+"</span>";if((k.error||k.warning)&&i.hasClass(fa))return f=k.error?"is-error":"is-warning","<span class='"+f+"'>"+a.escapeHTML(k.message)+"</span>";if(k.agg&&m&&(g=e.options.aggregateTooltips[k.agg+"|"+m.property]))return"<span class='"+f+"'>"+a.escapeHTML(g)+"</span>"}return d._originalContent?d._originalContent.call(this,b,e.model,k,l,m):null},d.open=function(a,b){b.tooltip.find(".is-error").length&&b.tooltip.addClass("is-error"),b.tooltip.find(".is-warning").length&&b.tooltip.addClass("is-warning")},this.element.find(F+","+D).tooltip(d)))):void c.warn("tooltip option ignored because missing tooltip widget dependency")},_destroy:function(){var a=this.element;this._tableModelViewDestroy(),a.removeClass(B+" "+Ca+" "+Sa).removeAttr("role").removeAttr(Ma).removeAttr(Na).attr(Qa,this.origLabelBy).empty(),f.removeHandler(a[0]),c.info("Grid '"+a[0].id+"' destroyed. Model: "+this.options.modelName),this.tableData$=null,this.tableFrozenData$=null,this._initModel(null),this.gridStyles$&&this.gridStyles$.remove(),this._destroyContextMenu()},_setOption:function(a,b){var d=this.element,e=this.options;if(c.info("Grid '"+d[0].id+"' set option '"+a+"' to: ",b),this._checkContextMenuOptions(a,b),"allowCopy"===a)throw new Error("Grid "+a+" cannot be set");"editable"===a&&!b&&this.editMode?this.setEditMode(!1):"multiple"===a&&this.setSelection(h()),this._super(a,b),this._enforceOptionConstraints(),"disabled"===a?(d.toggleClass(Ca,b),this.lastFocused&&(b?this.lastFocused.tabIndex=-1:this._setFocusable(this.lastFocused)),b&&this.resize()):"selectCells"===a?this._setSelectionMode():"multiple"===a?(b?d.attr(Ma,Za):d.removeAttr(Ma),e.rowHeader!==Wa&&e.rowHeaderCheckbox&&this.refreshColumns(),this.refresh()):"modelName"===a?(this.editMode&&this.setEditMode(!1),this._initModel(b),this.refresh(!1)):"highlights"===a?this._updateHighlights():"tooltip"===a?this._initTooltips(b):"rowHeader"!==a&&"rowHeaderCheckbox"!==a&&"rowHeaderLabelColumn"!==a&&"columnSort"!==a&&"resizeColumns"!==a&&"reorderColumns"!==a&&"editable"!==a&&"pagination"!==a&&"selectAll"!==a&&"footer"!==a&&"autoAddRecord"!==a||("editable"===a&&(b?d.removeAttr(Na):d.attr(Na,Za)),this._refreshGrid())},_enforceOptionConstraints:function(){var a=this.options;a.rowHeaderCheckbox&&a.rowHeader===Wa&&(c.warn("Option rowHeaderCheckbox cannot be true when rowHeader is 'none'."),a.rowHeaderCheckbox=!1),!a.multiple||a.rowHeader!==Wa&&a.rowHeaderCheckbox||!apex.userHasTouched()||(a.rowHeader===Wa&&(a.rowHeader="plain"),a.rowHeaderCheckbox=!0),a.editable&&a.allowEditMode||(a.autoAddRecord=!1),a.rowHeader!==Wa&&(a.rowHeaderWidth?this.rowHeaderWidth=a.rowHeaderWidth:(a.rowHeaderCheckbox?this.rowHeaderWidth=34:this.rowHeaderWidth=16,a.rowHeader!==Xa&&a.rowHeader!==Ya||(this.rowHeaderWidth+=38)))},refresh:function(a){var b,d,e,f,g,i,j,k,l=!1,m=null,n=null,o=null,p=this,r=this.options,s=this.element;if(c.info("Grid '"+s[0].id+"' refreshed. Model: "+r.modelName),a!==!0&&(l=this._paginationHasFocus()),void 0===a&&(a=h(document.activeElement).closest(s[0]).length>0),this._refreshCheckIfVisible()){if(m=s.find(Ga),m.length&&this._deactivateCell(m),this.focusInHeader?this.columnsStale&&this.columns&&(o=q(h(this.lastFocused).closest(Q)),d=h(this.lastFocused).closest("th").attr(qb),d&&(d=this.columns[d].property),this.lastFocused=null):this.lastFocused=null,this.tableData$&&(!r.persistSelection||r.selectCells))if(r.selectCells)e=this.getSelection(),e.length>0&&(m=e[0].first(),f=q(m),this.tableFrozenData$&&0===m.closest(this.tableFrozenData$).length&&(f+=this.tableFrozenData$.find(Q).first().children().length),n={rowIndex:q(m.parent()),colIndex:f});else{for(e=this.getSelection(),n=[],b=0;b<e.length;b++)i=e[b].first().attr(rb),void 0!==i&&n.push(i);0===n.length&&(n=null)}this._refreshPagination(s.find(L)),this.columnsStale||!this.columns?this._initGrid():(this.tableFrozenData$&&this.tableFrozenData$.empty(),this.tableData$.empty(),this._clearChildrenRowCache()),this.controlBreaks=[],this._updateStatus(),this.noData||this.resize(),j=s.find(D),null!==o&&d&&(k=r.columns[0][d],k&&(d=k.seq-1,j.find("thead").each(function(){if(m=h(this).children().eq(o).find("th[data-idx='"+d+"']"),m.length)return!1})),m&&m.length||(m=j.find("thead").first().find(Q).eq(o).children().first()),m&&m.length&&(p._select(m,null,a,!1,!0),a=!1)),this.allSelected=!1,this._addPageOfRecords(function(){var b,c,d,i,k=!1;if(l&&(p._restorePaginationFocus(l),a=!1),s.find(W+" "+ea).attr("aria-disabled",p.noData?Za:$a).toggleClass(Ca,p.noData),p._updateAccLabel(),r.hasSize&&p._calculateColumnWidths(null,!0,!0),p.lastHoverCell=null,p.lastHoverRow=null,p.lastFocused&&h(p.lastFocused).is(Ta)||(p.lastRow$=null,p.lastFocused=p._getCellFocusable(s.children(F).find("tbody tr").first().children().first()),p.lastFocused?(p.selectAnchor=p.lastFocused,p.focusInHeader=!1):(p.lastFocused=p._getCellFocusable(j.find("thead").first().find(Q).last().children().first()),p.focusInHeader=!0),p.lastFocused&&!r.disabled&&(p._setFocusable(p.lastFocused),p._setCurrentRow(p.lastFocused))),n){if(r.selectCells)p.tableData$.find(O).length>n.rowIndex&&(f=n.colIndex,g=p.tableData$,p.tableFrozenData$&&(d=p.tableFrozenData$.find(Q).first().children().length,f>d?f-=d:g=p.tableFrozenData$),c=g.find(O).eq(n.rowIndex).children(),f>=c.length&&(f=c.length-1),p.setSelection([c.eq(f)],a),k=!0);else{for(e=[],b=0;b<n.length;b++)i=p.model.getRecord(n[b]),i&&e.push(i);e.length>0&&(k=0!==p.setSelectedRecords(e,a))}k||(p._trigger(_a,{}),a&&p.focus())}else a&&p.focus()})}},focus:function(){this.lastFocused&&this.lastFocused.focus()},gotoCell:function(a,b){var d,e,f,g,h=this.options,i=!1,j=null,k=null,l=this.element.find("[data-id='"+a+"']");if(this.gotoCellPending=null,this.tableData$){if(b&&(j=h.columns[0][b],j?j.hidden&&j.canHide&&(j.hidden=!1,i=!0,this.refreshColumns(),this.gotoCellPending={record:a,column:b}):c.warn("Warning column not found "+b)),!l.length){if(d=this.model.getRecord(a),!d)return void c.warn("Warning record not found "+a);e=this.model.indexOf(d),this.gotoCellPending={record:a,column:b},h.pagination.scroll?(f=this.scrollParent$,g=Math.floor(e/this.displayPageSize)*this.displayPageHeight,f.scrollTop(g)):(this.pageOffset=Math.floor(e/this.pageSize)*this.pageSize,i=!0)}i&&this.refresh(!1),this.gotoCellPending||(b&&j&&(k=this._cellFromColumn(l,b)),k||(k=l.children().first()),this._select(k,null,!0,!1))}},getActiveCellFromColumnItem:function(a){var b,c=this,d=null;return this.activeRecordId&&(b=this.element.find("[data-id='"+this.activeRecordId+"']"),h.each(this.columnItems,function(e,f){a===f.item.node&&(d=c._cellFromColumn(b,e))})),d},inEditMode:function(){return this.editMode},setEditMode:function(a){function b(){g.columnItemsContainer$.off("change.gridedit"),g.activeRecord=null,g.activeRecordId=null}var d,e,f=!1,g=this;this.tableData$&&(this.options.editable?(a=!!a,this.lastFloatingPos={},d=a!==this.editMode,this.editMode=a,this.element.toggleClass("a-GV--editMode",a),e=u(this.lastFocused),e.length&&(a?this._activateCell(e):(this.lastEditModeCell=null,this._clearDeactivate(),this._deactivateCell(e),this.activeRecord&&(this._deactivateRow(b),f=!0))),d&&(a?this.columnItemsContainer$.on("change.gridedit",function(a){var b,c,d;if(g.activeRecord)for(b=0;b<g.columns.length;b++)if(c=g.columns[b],c.elementId===a.target.id){d=c.property,g.setActiveRecordValue(d);break}}):f||b(),this._trigger(ab,null,{editMode:a}))):a&&c.warn("Grid is not editable."))},getSelection:function(){var a,b,c=[];return this.tableData$&&(this.options.selectCells?(b=this.tableData$.find(ya).parent(Q),this.tableFrozenData$&&(a=this.tableFrozenData$.find(ya).parent(Q)),a&&a.length?a.each(function(a){c.push(h(this).find(ya).filter(R).add(b.eq(a).find(ya).filter(R)))}):b.each(function(){c.push(h(this).find(ya).filter(R))})):(b=this.tableData$.find(ya).filter(Q),this.tableFrozenData$?(a=this.tableFrozenData$.find(ya).filter(Q),a.each(function(a){c.push(h([this,b[a]]))})):b.each(function(){c.push(h(this))}))),c},setSelection:function(a,b,c){var d,e,f=null,g=this.lastFocused,i=this.focusInHeader,j=[];if(this.tableData$){if(this.options.selectCells)h.isArray(a)||(a=[a]),e=a[0].first()[0],j.push(a[a.length-1].last()[0]),e!==j[0]&&(this._select(h(e),null,null,!1,!1),f={type:"click",shiftKey:!0});else if(h.isArray(a))for(d=0;d<a.length;d++)e=a[d].children(R)[0],e&&j.push(e);else a.each(function(){e="TR"===this.nodeName?h(this).children(R)[0]:h(this).closest(R)[0],e&&j.push(e)});this.focusInHeader=!1,this._select(h(j),f,b,!1,c),b||(this.focusInHeader=i,i&&(this._setFocusable(g),this._setCurrentRow(g)))}},selectAll:function(a,b){var c=[],d=this.options,e=this.tableFrozenData$||this.tableData$;e&&d.multiple&&d.selectAll&&!d.selectCells&&(e.children().each(function(){c.push(h(this).children()[0])}),this.setSelection(h(c),a,b))},getRecords:function(a){var b,c,d,e=[];for(b=0;b<a.length;b++)c=a[b].first().attr(rb),void 0!==c&&(d=this.model.getRecord(c),d&&e.push(d));return e},getSelectedRange:function(){var a,b,c,d,e,f,g,h=this.options,i=null;if(h.selectCells)for(i={columns:[],recordIds:[],values:[]},a=this.getSelection(),b=0;b<a.length;b++){if(e=a[b],0===b)for(c=0;c<e.length;c++)g=this._getColumnMetadata(e.eq(c)),i.columns.push(g?g.property:null);for(f=e.first().parent().attr(rb),i.recordIds.push(void 0!==f?f:null),d=[],c=0;c<e.length;c++)d.push(e.eq(c).text());i.values.push(d)}return i},getSelectedRecords:function(){var a=this.options;return a.selectCells?[]:a.persistSelection?this.model.getSelectedRecords():this.getRecords(this.getSelection())},setSelectedRecords:function(a,b,c){var d,e=0,f=[],g={},i=this.tableFrozenData$||this.tableData$;if(!i)return-1;if(this.options.selectCells)return-1;for(d=0;d<a.length;d++)g[this.model.getRecordId(a[d])]=!0;return i.children().each(function(){var a=h(this),b=a.attr(rb);g[b]&&(f.push(a),e+=1)}),this.setSelection(f,b,c),e},activateRow:function(a,b){var c=!1,d=h(this.lastEditModeCell),e=a.parent(),f=e.attr(rb);this.editMode&&f===this.activeRecordId||(this.element.one("apexbeginrecordedit",function(){b()}),c=!0),this.editMode?(d.length&&(d.removeClass(za),this._deactivateCell(d)),a.addClass(za),this._activateCell(a)):(this.lastFocused=a[0],this.setEditMode(!0)),c||b()},activateCell:function(a){var b=h(this.lastEditModeCell);return!!this.editMode&&(a[0]===this.lastEditModeCell||(b.length&&(b.removeClass(za),this._deactivateCell(b)),a.addClass(za),this._activateCell(a)))},copyDownSelection:function(a,b){return this._setSelectionValues(1,a,b)},fillSelection:function(a,b,c){return this._setSelectionValues(0,b,c,a)},_setSelectionValues:function(a,b,c,d){function e(){j=[],k.each(function(c){var e,f,g,i=h(this),k=l._getColumnMetadata(i);k&&b.indexOf(k.property)>=0&&k.elementId&&(e=l.columnItems[k.property].item,f={index:c,item:e},1===a?(f.value=e.getValue(),g=e.displayValueFor(f.value),f.value!==g&&(f.displayValue=g)):f.value=d,j.push(f))}),o=a,f()}function f(){for(var a,b,d;;){if(o>=i.length||!j.length){d=h(l.lastEditModeCell),d.removeClass(za),m?d.length&&l._deactivateCell(d):l.setEditMode(!1),l.setSelection(i),h(n).focus(),c&&c();break}if(o>0&&(k=p.selectCells?i[o]:i[o].children()),o+=1,a=k.first().parent().attr(rb),l.model.allowEdit(l.model.getRecord(a))){b=k.first(),!p.selectCells&&p.rowHeader!==Wa&&k.length>=2&&(b=k.eq(1)),l.activateRow(b,g);break}}}function g(){var a,b;for(a=0;a<j.length;a++)b=j[a],l.activateCell(k.eq(b.index))&&b.item.setValue(b.value,b.displayValue);f()}var i,j,k,l=this,m=this.editMode,n=this.lastFocused,o=0,p=this.options;return i=this.getSelection(),!(i.length<=a)&&(b||(b=[],p.selectCells?this.getSelectedRange().columns.forEach(function(a){a&&b.push(a)}):this.columns.forEach(function(a){var c=a.property;!c||a.hidden||a.virtual||a.noCopy||l.model.isIdentityField(c)||!a.elementId||a.readonly||b.push(c)})),k=p.selectCells?i[o]:i[o].children(),this.activateRow(k.first(),e),!0)},resize:function(){var a,b,c,d,e=this.element,f=this.options,g=e.height(),i=e.width(),j=e.children(D),k=e.children(F);if(null!==e[0].offsetParent){if(!k.length||this.pendingRefresh)return void this.refresh();d=this.tableData$.prev().height(),e.find(F+" "+P).css("margin-top",-(d+parseInt(this.tableHeader$.find("th").first().css("border-bottom-width"),10))),a=i,this.tableFrozenData$&&(c=this.tableFrozenData$.closest(H).width(),e.find(H).width(c).toggleClass("a-GV-w-frozen--showLabels",c>kb),this.tableData$.parent().parent().find(wa).css("visibility",c>kb?"hidden":"visible"),a-=c),e.find(L+","+J).width(a),h.apex.stickyWidget&&e.find(".js-stickyWidget-toggle").stickyWidget("refresh"),f.hasSize&&(b=g-j.height()-this._footerHeight(),k.children(L).addBack().height(b)),this._calculateColumnWidths(null,!0,f.hasSize||this.tableData$.parent().width()>a),this._initPageSize()}},expandControlBreak:function(a){this._expandCollapseControlBreak(a,!0)},collapseControlBreak:function(a){this._expandCollapseControlBreak(a,!1)},getColumns:function(){return this.columns},refreshColumns:function(){this.columnsStale=!0},setColumnWidth:function(a,b){var c=this._updateColumnWidth(a,b,!0);this._trigger(db,null,{header$:c[1],column:c[0],width:b})},hideColumn:function(a){var b=this._columnName(a);this.options.columns[0][b].hidden=!0,this._refreshGrid()},showColumn:function(a){var b=this._columnName(a);this.options.columns[0][b].hidden=!1,this._refreshGrid()},freezeColumn:function(a){var b,c,d=this.columns,e=this._columnName(a);for(b=0;b<d.length&&(c=d[b],b<d.length-1&&(c.frozen=!0),c.property!==e);b++);this._refreshGrid()},unfreezeColumn:function(a){var b,c,d=this._columnName(a);
for(b=this.columns.length-1;b>=0&&(c=this.columns[b],c.frozen=!1,c.property!==d);b--);this._refreshGrid()},moveColumn:function(a,b){var c=this._moveColumn(a,b);this._refreshGrid(),c.header$=this._columnFromIndex(b),this._trigger(cb,null,c)},moveColumnGroup:function(a,b,c){var d,e,f,g,h,i,j,k=[];if(f=this.columnGroups[a],!f)throw new Error("Invalid column group level: "+a);for(g=-1,d=0;d<f.length;d++)e=f[d],d===b&&(g=e.start,h=e.end),d===c&&(i=g===-1?e.start:e.end);if(c>b)for(d=g;d<=h;d++)j=this._moveColumn(this.columns[g],i),j.newPosition=i-(h-d),j.oldPosition=d,k.push(j),this._updateColumns();else for(d=h;d>=g;d--)j=this._moveColumn(this.columns[h],i),j.newPosition=i+(d-g),j.oldPosition=d,k.push(j),this._updateColumns();for(this._refreshGrid(),d=0;d<k.length;d++)j=k[d],j.header$=this._columnFromIndex(j.newPosition),this._trigger(cb,null,j)},_refreshGrid:function(){var a;a=this.element.find(Ga),a.length&&this._deactivateCell(a),this.refreshColumns(),this.refresh()},_cellFromColumn:function(a,b){var d,e,f,g=this.columns,h=this.options,i=null,j=0;if(e=h.columns[0][b],!e)return c.warn("Warning column not found "+b),null;for(h.rowHeader!==Wa&&(j=1),d=0;d<g.length;d++)if(f=g[d],!f.hidden){if(f.property===b){i=a.children().eq(j);break}j+=1}return d>=g.length&&c.warn("Warning column is hidden "+b),i},_columnFromIndex:function(a){return this.element.find(".a-GV-header[data-idx='"+a+"']")},_columnName:function(a){var b;if(b="object"==typeof a?a.property:a,!this.options.columns[0].hasOwnProperty(b))throw new Error("Unknown column: "+b);return b},_moveColumn:function(a,b){var c,d,e,f,g=this.columns,h=this._columnName(a);for(e=-1,c=0;c<g.length;c++)if(d=g[c],d.property===h){e=c;break}if(f=g[b].seq,e!==b){if(e<b)for(c=b;c>e;c--)g[c].seq=g[c-1].seq;else for(c=b;c<e;c++)g[c].seq=g[c+1].seq;return g[e].frozen=b<=this.lastFrozenColIndex,g[e].seq=f,{column:d,newPosition:b,oldPosition:e}}},_updateColumns:function(){var a,b,c,d,e,f,g,i,j,k,l,m,n,o={},p=this.options,q=p.columns[0];this.columns=[],this.columnsStale=!1,this.columnGroups=[],this.breakColumns=[],this.fieldToColumnIndex={};for(d in q)q.hasOwnProperty(d)&&(c=q[d],c.property=d,c.domId=c.elementId?c.elementId+"_HDR":this.idPrefix+"_h_"+c.property,c.seq=c.seq||"0",this.columns.push(c));for(this.columns.sort(function(a,b){return a.seq-b.seq}),this.lastFrozenColIndex=-1,a=0;a<this.columns.length;a++)if(c=this.columns[a],!c.hidden){if(!c.frozen)break;this.lastFrozenColIndex=a}for(l=p.rowHeader!==Wa?1:0,a=0;a<this.columns.length;a++)c=this.columns[a],c.controlBreakIndex>0&&this.breakColumns.push(c),c.hidden||(this.fieldToColumnIndex[c.property]=l,l+=1);for(this.breakColumns.sort(function(a,b){return a.controlBreakIndex-b.controlBreakIndex}),f=null,i=null,j=null,m=!0,l=0,g=0,b=0,n=[],a=0;a<this.columns.length;a++)if(c=this.columns[a],!c.hidden){if(null===f&&(f=[],this.columnGroups.push(f)),k=z(c),k!==i||a===this.lastFrozenColIndex+1){if(i=k,j&&(j.span=l-g,j.end=b,j.children=n,n=[]),g=l,k){if(j=h.extend({},p.columnGroups[k]),!j)throw new Error("Unknown column group name: "+k);j.heading&&(m=!1,o[k]||(j.domId=this.idPrefix+"_g_"+k)),j.property=k,f.push(j)}else j={},f.push(j);j.start=a,a<=this.lastFrozenColIndex&&(j.frozen=!0,o[k]=1)}n.push(c),l+=1,b=a,null===j&&(j={start:a},this.lastFrozenColIndex>=0&&(j.frozen=!0),f.push(j))}for(j&&(j.span=l-g,j.end=b,j.children=n),m&&(this.columnGroups=[],f=null);f;){for(e=f,f=null,i=null,j=null,m=!0,l=0,n=[],a=0;a<e.length;a++){if(c=e[a],k=c.parentGroupName||null,k!==i||c.frozen!==(!!j&&j.frozen)){if(i=k,null===f&&(f=[],this.columnGroups.unshift(f),l>0&&(j={},c.frozen&&(j.frozen=!0),f.push(j))),j&&(j.span=l-g,j.children=n,n=[]),g=l,k){if(j=h.extend({},p.columnGroups[k]),!j)throw new Error("Unknown column group name: "+k);j.heading&&(m=!1,o[k]||(j.domId=this.idPrefix+"_g_"+k)),j.property=k,f.push(j)}else j={},f.push(j);j.start=c.start,c.frozen&&(j.frozen=!0,o[k]=1)}n.push(c),j.end=c.end,l+=c.span}j&&(j.span=l-g,j.end=c.end,j.children=n),m&&(this.columnGroups.shift(),f=null)}},_initGrid:function(){function b(){y!==A&&(f[0].scrollLeft=y=A,i[0].scrollLeft=y,s.css("left",y)),z!==B&&(z=B,j[0]&&(j[0].scrollTop=z),i[0].scrollTop=z),C=null}function d(a){var b,c;if(v){if(c=a-v,b=w*c,w/=1.6,b>-2&&b<2)return void(w=0);j[0].scrollTop=i[0].scrollTop=z=B=j[0].scrollTop-b}v=a,xb(d)}function e(){var a=E.element.find(Ga);E.floatingItem$.hasClass(Da)?E._collapseFloatingItem(a):E._expandFloatingItem(a)}var f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=0,z=0,A=0,B=0,C=null,E=this,G="scroll.gvss",I=this.options,K=this.element,M="a-GV-table--checkbox";c.info("Grid render and initialize."),this._updateColumns(),this.columnItems||this._initColumnItems(this.columns),this._renderGrid(),K.find(D+" "+Ua).prop(tb,-1),I.tooltip&&this._initTooltips(I.tooltip),I.rowHeader!==Wa&&I.rowHeaderCheckbox&&(this.tableFrozenHeader$.parent().addClass(M),this.tableFrozenData$.parent().addClass(M)),f=K.find(J),i=K.find(L),j=K.find(H).last(),k=K.children(F),p=k.find("col"),q=k.find("thead").find(".a-GV-header"),x=this.tableData$.parent().width()-a.getScrollbarSize().width,this.tableFrozenData$&&(x-=this.tableFrozenData$.parent().width()),f.add(i).width(x),p.each(function(a){var b=h(this),c=E.columns[b.attr(qb)];c&&(c.width?c.curWidth=c.width:c.curWidth=c.defWidth=q.eq(a).width(),c.curWidth<jb&&(c.curWidth=jb))}),s=this.tableData$.parent().parent().find(wa),i.on(G,function(){A=this.scrollLeft,B=this.scrollTop,C||(C=xb(b))}),f.on(G,function(){A=this.scrollLeft,C||(C=xb(b))}),j.on(G,function(){B=this.scrollTop,C||(C=xb(b))}),I.hasSize&&j.length&&(j.on(yb,function(a){var c=a.originalEvent.deltaY||a.originalEvent.detail||-.025*a.originalEvent.wheelDelta;void 0!==a.originalEvent.deltaMode&&1!==a.originalEvent.deltaMode||(c=30*c),B=this.scrollTop+c,C||(C=xb(b)),a.preventDefault()}),apex.userHasTouched()&&(t=new Hammer(j[0]),t.get("pan").set({direction:Hammer.DIRECTION_VERTICAL}),t.on("panup pandown",function(a){B=u-a.deltaY,C||(C=xb(b)),w=0,a.isFinal&&(a.velocityY>=.1||a.velocityY<=-.1)&&(v=0,w=a.velocityY,xb(d))}),t.on("panstart",function(){u=j[0].scrollTop}))),m=this.element.find(pa),this.tabTraps$=m,2===m.length?n=0:(3===m.length?(n=1,o=0):(n=4,o=3,m.eq(0).on("focus",function(){E.lastEditModeCell?E.tableData$.find(Ua).first().focus():E._prevCellWithWrap(h(E.lastFocused)).focus()}),m.eq(1).on("focus",function(){E.tableData$.find(Ua).last().focus()}),m.eq(2).on("focus",function(){E.tableFrozenData$.find(Ua).first().focus()})),m.eq(o).on("focus",function(){h(this).hasClass(qa)?E._autoAddRecord(E.activeRecord):(E.tableFrozenData$?E.tableFrozenData$:E.tableData$).find(Ua).last().focus()})),m.eq(n).on("focus",function(){var a,b,c=h(E.lastEditModeCell).closest("tbody"),d=c.find(Ua).add(E.lastEditModeCell),e=d.index(E.lastEditModeCell);e>0?d.first().focus():E.tableFrozenData$&&0===m.eq(0).prop(tb)?(c=c[0]===E.tableFrozenData$[0]?E.tableData$:E.tableFrozenData$,c.find(Ua).first().focus()):(a=h(Ua),b=E.element.find(Ua).first(),e=a.index(b),a.eq(e-1).focus())}),m.eq(n+1).on("focus",function(){var a=h(E.lastEditModeCell).closest("tbody"),b=a.find(Ua).add(E.lastEditModeCell),c=b.index(E.lastEditModeCell);h(this).hasClass(qa)?E._autoAddRecord(E.activeRecord):c<b.length-1?b.last().focus():E.tableFrozenData$&&(a=a[0]===E.tableFrozenData$[0]?E.tableData$:E.tableFrozenData$,a.find(Ua).last().focus())}),m.prop(tb,-1),I.reorderColumns&&this._initColumnReorder(),this.columnWidthHandle$=h(),I.resizeColumns&&this._initColumnResize(),this.columnControls$.on("click","button",function(a){var b=h(a.target);E._sortChange(a,b.closest(W),b.closest("button").hasClass("js-asc")?"asc":"desc")}),this.floatingItem$.draggable({handle:".a-GV-cellMoveHandle",containment:"body",stop:function(a,b){var c=E._getColumnMetadata(E.element.find(Ga)).property;E.lastFloatingPos[c]={left:b.position.left,top:b.position.top}}}).on("keydown",function(a){var b=a.which;return a.ctrlKey&&117===b?(e(),!1):void(112===b&&a.altKey?E._doHelpKey():b===vb.ESCAPE&&E._doEscapeKey(a))}).on("mousedown",function(a){h(a.target).hasClass("a-GV-cellMoveHandle")&&E._clearDeactivate()}).on("focusin",function(){E._clearDeactivate()}).on("focusout",function(){E.lastEditModeCell&&E._beginDeactivate(h(E.lastEditModeCell))}).children(va).click(e),g.TouchProxy.addTouchListeners(this.floatingItem$[0]),this._initPaginationFooter(i),!I.hasSize&&I.stickyTop&&h.apex.stickyWidget&&(r={stickToEnd:!0,toggleWidth:!0,bottom:function(){return K.offset().top+K.outerHeight()-E._footerHeight()}},h.isFunction(I.stickyTop)&&(r.top=I.stickyTop),K.find(D).css("overflow","hidden").stickyWidget(r)),this.breakColumns.length>0&&I.collapsibleControlBreaks&&K.find(F).on("click",".js-toggleBreak",function(){l=h(this).closest("."+ka),E._expandCollapseControlBreak([l],!l.hasClass(Da))})},_initColumnReorder:function(){var a,b,c,d,e,f,i,j,k,l,m,n,o,p,r=this.element.hasClass(Sa),s=this.element.find(D),t=this;s.append(this.columnMoveMarker$),p=parseInt(t.columnHandle$.css("margin-left"),10),r&&(p=-p),t.columnHandle$.draggable({appendTo:this.element,containment:s,cursor:"move",cursorAt:r?{right:-2*p}:{left:0},axis:"x",delay:100,distance:4,helper:function(){var a=h("<div class='a-GV-header-dragHelper'></div>"),b=t.columnReorderCell$;return a.append(b.find(".a-GV-headerLabel,."+aa).clone()),a.width(b.outerWidth()),a},start:function(g,p){t.columnControls$.hide(),t._trigger(fb,g,{}),a=t.columnReorderCell$.parent().offset().top-t.element.offset().top,b=a+t.element[0].offsetTop,f=s.css("position"),j="absolute",i=2,k=-s.offset().left,"relative"!==f&&("fixed"===f&&(k=0,a=b=t.columnReorderCell$.parent()[0].offsetTop+s[0].offsetTop,j="fixed",p.helper.css("margin-left",t.element.offset().left+"px")),i=parseInt(s.css("z-index"),10)+1),l=-t.columnMoveMarker$.width()/2,p.helper.css({top:b+"px",position:j,"z-index":i}),n=p.helper.outerWidth(),t.columnMoveMarker$.show().css({top:a+"px",left:t.columnReorderCell$.offset().left+k+(r?t.columnReorderCell$.width():0)+"px",position:j,"z-index":i}),t.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").hide(),t.columnHandle$.hide(),t.columnWidthHandle$.hide(),x(function(){t.columnReorderCancel=!0}),m=parseInt(t.columnReorderCell$.attr(qb),10),t.hdrScrollParent=t.element.find(J)[0],o=t.hdrScrollParent.scrollLeft,c=[],e=null,d=t._getRowForCell(t.columnReorderCell$),d.children().each(function(){var a=h(this),b=!0,d=a.offset().left+k;a.parent().parent().parent().parent()[0]===t.hdrScrollParent&&(d+=o,b=!1),c.push({colIdx:parseInt(a.attr(qb),10),start:d,end:d+a.outerWidth(),frozen:b})}),t.columnReordering=!0,t.columnReorderCancel=!1},drag:function(a){function b(){var b,g,h,i=!1,j=a.pageX-p+k+t.hdrScrollParent.scrollLeft;for(b=0;b<c.length;b++)if(g=c[b],j>=g.start&&j<g.end){b!==e&&(e=b,h=r?(g.colIdx<m?g.end:g.start)+l:(g.colIdx<m?g.start:g.end)+l,g.frozen||(h-=t.hdrScrollParent.scrollLeft),f=h,d=t.hdrScrollParent.scrollLeft,t.columnMoveMarker$.css("left",h+"px"),i=!0);break}i||d===t.hdrScrollParent.scrollLeft||(h=f-(t.hdrScrollParent.scrollLeft-d),t.columnMoveMarker$.css("left",h+"px"))}var d=t.hdrScrollParent.scrollLeft,f=parseInt(t.columnMoveMarker$.css("left"),10);return t.columnReorderCancel?void a.preventDefault():(b(),void(t._headerScrollCheck(a.pageX-p,n)?t.scrollTimerId||t._headerScrollStart(a.pageX-p,n,b):t.scrollTimerId&&t._headerScrollStop()))},stop:function(){var a=null;null!==e&&(a=c[e].colIdx),isNaN(a)&&e+1<c.length&&(a=c[e+1].colIdx),isNaN(a)||(t.columnReordering=!1,t.columnReorderCell$.find(".a-GV-headerLabel,.a-GV-header-sort").show(),a===m&&(t.columnHandle$.show(),t.columnWidthHandle$.show(),t.columnControls$.show()),t.columnMoveMarker$.hide(),t.lastHoverCell=null,y(),t.scrollTimerId&&t._headerScrollStop(),t.columnReorderCancel||null===a||a===m||(t.columnReorderCell$.hasClass(X)?t.moveColumnGroup(q(d),m,a):t.moveColumn(t.columns[m],a),t.focus()))}}),g.TouchProxy.addTouchListeners(t.columnHandle$[0])},_initColumnResize:function(){var a,b,c,d=this,e=this.element.hasClass(Sa)?-1:1,f=this.element.find(D),i=f.find(Q).last();this.columnWidthHandle$=h("<div class='a-GV-columnWidthHandle'></div>").appendTo(f).css("top",i[0].offsetTop).height(i.height()),this.columnWidthHandle$.draggable({axis:"x",containment:f,start:function(e,f){d.columnWidthDragging=!0,d.columnWidthCancel=!1,d.columnWidthStartPos=f.position.left,d.columnWidthStartWidth=d.columnWidthCell$.first().outerWidth(),a=f.helper.outerWidth(),d.hdrScrollParent=d.element.find(J)[0],c=d.columnWidthCell$.parent().parent().parent().parent()[0]!==d.hdrScrollParent,b=d.hdrScrollParent.scrollLeft,x(function(){d.columnWidthCancel=!0})},drag:function(f,g){function h(a){var f,h,i=d.columnWidthStartWidth+e*(g.position.left-d.columnWidthStartPos);f=d.hdrScrollParent.scrollWidth,c||(i+=d.hdrScrollParent.scrollLeft-b),i>jb&&(d.columnWidthCell$.hasClass(fa)?(d.rowHeaderWidth=i,d._calculateColumnWidths()):d._updateColumnWidth(d._getColumnMetadata(d.columnWidthCell$.first()),i)),h=d.hdrScrollParent.scrollWidth-f,h<0&&!a&&d.hdrScrollParent.scrollLeft!==b&&(d.hdrScrollParent.scrollLeft+=h,b+=h)}return d.columnWidthCancel?void f.preventDefault():(h(),void(d._headerScrollCheck(g.offset.left,a)?d.scrollTimerId||d._headerScrollStart(g.offset.left,a,function(){h(!0)}):d.scrollTimerId&&d._headerScrollStop()))},stop:function(a,f){var g=d.columnWidthStartWidth+e*(f.position.left-d.columnWidthStartPos);c||(g+=d.hdrScrollParent.scrollLeft-b),d.columnWidthDragging=!1,y(),d.scrollTimerId&&d._headerScrollStop(),d.columnWidthCancel&&(g=d.columnWidthStartWidth),g<jb&&(g=jb),d.columnWidthCell$.hasClass(fa)?(d.rowHeaderWidth=g,d._calculateColumnWidths(null,!0)):d.setColumnWidth(d._getColumnMetadata(d.columnWidthCell$.first()),g)}}),g.TouchProxy.addTouchListeners(this.columnWidthHandle$[0])},_updateColumnWidth:function(a,b,c){var d,e,f,g=this._columnName(a);return d=this.options.columns[0][g],d.width=b,d.curWidth=b,f=this.columns.indexOf(d),e=this._columnFromIndex(f),this._calculateColumnWidths(e,c),[d,e]},_calculateColumnWidths:function(b,c,d){function e(a){var b,c;for(b=a+1;b<v.columns.length;b++)if(c=v.columns[b],!c.hidden&&!c.noStretch&&b!==q)return!1;return!0}function f(a,b){var c,d=b.parent().find("col"),e=a.parent().find("col");return c=0,e.each(function(a){var b,e,f=h(this),g=f.attr(qb);g?(e=v.columns[g],b=e.curWidth):b=v.rowHeaderWidth,f[0].width=b,d[a].width=b,c+=b}),b.parent().width(c),a.parent().width(c),c}var g,i,j,k,l,m,n,o,p,q,r,s,t=this.options.hasSize,u=this.element,v=this;if(d)for(g=0;g<this.columns.length;g++)i=this.columns[g],i.curWidth=i.width||i.defWidth,i.curWidth<jb&&(i.curWidth=jb);if(c&&this.tableFrozenHeader$&&this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each(function(){h(this).find(W).first().css("height","")}),b&&(m=b.parent().parent()[0],q=parseInt(b.attr(qb),10)),!this.tableFrozenData$||m&&m!==this.tableFrozenHeader$[0]||(f(this.tableFrozenData$,this.tableFrozenHeader$),k=this.tableFrozenData$.parent().outerWidth(),u.find(H).width(k),j=u.width()-k,u.find(L+","+J).width(j)),j=m&&m!==this.tableHeader$[0]?this.tableData$.parent().width():f(this.tableData$,this.tableHeader$),c){if(l=u.find(L).width(),t&&0===this.tableData$.children().length&&(l-=a.getScrollbarSize().width),j<l){if(l=l-j-1,l>10)for(p=l,g=0;g<this.columns.length;g++)i=this.columns[g],i.hidden||i.frozen||i.noStretch||g===q||(e(g)?i.curWidth+=p:(o=Math.floor(l*(i.curWidth/j)),i.curWidth+=o,p-=o));else for(g=this.columns.length-1;g>0;g--)if(i=this.columns[g],!(i.hidden||i.frozen||i.noStretch||g===q)){i.curWidth=i.curWidth+l;break}f(this.tableData$,this.tableHeader$)}this.tableFrozenHeader$&&(s=this.tableFrozenHeader$.find(W).outerHeight(),r=this.tableHeader$.find(W).outerHeight(),s!==r&&(r=Math.max(s,r),this.tableData$.prev().add(this.tableFrozenData$.prev()).add(this.tableHeader$).add(this.tableFrozenHeader$).each(function(){h(this).find(W).first().css("height",r+"px")})))}t&&(n=u.children(F),this._adjustSizeForScrollBars(n.height(),n.find(L).width()))},_renderGrid:function(){function b(a,b){var c,d;for(b&&l.rowHeader!==Wa&&a.markup("<col").optionalAttr("width",j.rowHeaderWidth).markup("/>"),c=0;c<j.columns.length;c++)d=j.columns[c],(d.frozen||!1)!==b||d.hidden||a.markup("<col").optionalAttr("width",d.width).attr(qb,c).markup("/>")}function c(a,b,c){var d,e,f,h,k,o,p,q,r,s=j.columns,t=j.lastFrozenColIndex+1,u=s.length;for(e=0;e<j.columnGroups.length;e++){for(o=j.columnGroups[e],a.markup("<tr class='"+N+"' role='row'>"),d=0;d<o.length;d++)for(b&&l.rowHeader!==Wa&&(a.markup("<th role='columnheader' class='"+X+" "+fa+"'"),c&&a.markup(" style='visibility: hidden;'"),a.markup(">")),d=0;d<o.length;d++)f=o[d],(f.frozen||!1)===b&&(h=X,h+=i(f.headingAlignment||"center",!0),r=c?null:f.domId,a.markup("<th role='columnheader' ").attr("class",h).attr(pb,f.span).attr(qb,d),c&&a.markup(" style='visibility: hidden;'"),a.markup(" tabindex='-1'><span class='"+Z+"'").optionalAttr("id",r).markup(">"+(f.heading||"")).markup("</span></th>"));a.markup("</tr>")}for(a.markup("<tr class='"+N+"' role='row'>"),b&&(l.rowHeader!==Wa&&(q=null,c&&(q="visibility: hidden;"),a.markup("<th role='columnheader' class='"+V+" "+fa+"'").optionalAttr("style",q).markup("><span class='u-vh "+Z+"'").optionalAttr("id",c?null:j.idPrefix+"_shh").markup(">").markup(m("ROW_HEADER")).markup("</span>"),l.rowHeaderCheckbox&&l.multiple&&l.selectAll&&a.markup("<span class='"+ca+"' role='checkbox' aria-checked='false'").attr("title",m("SELECT_ALL")).markup("></span>"),l.rowHeader===Xa?a.markup("<span class='a-GV-rownum' aria-hidden='true'></span>"):l.rowHeader===Ya&&a.markup("<span class='a-GV-rowLabel'></span>"),a.markup("</th>")),t=0,u=j.lastFrozenColIndex+1),d=t;d<u;d++)f=s[d],f.hidden||(h=V,h+=i(f.headingAlignment||"center",!0),f.isRequired&&(h+=" is-required"),f.elementId&&!f.readonly||(h+=" "+Ia),f.headingCssClasses&&(h+=" "+f.headingCssClasses),p=null,1===f.sortIndex&&("asc"===f.sortDirection?p="ascending":"desc"===f.sortDirection&&(p="descending")),q=null,c?(q="visibility: hidden;",r=null):r=f.domId,a.markup("<th role='columnheader' ").attr("class",h).attr(qb,d).optionalAttr("style",q).optionalAttr("aria-sort",p).optionalAttr("aria-haspopup",l.activateColumnHeader?Za:null).markup(" tabindex='-1'><span class='"+Z+"'").optionalAttr("id",r).markup(">").markup(f.heading).markup("</span>"),f.sortDirection&&(k=n("asc"===f.sortDirection?"SORTED_ASCENDING":"SORTED_DESCENDING",g>1?f.sortIndex:""),a.markup("<span class='a-GV-header-sort'><span aria-hidden='true'").attr("class","a-Icon "+("asc"===f.sortDirection?"icon-irr-sort-asc":"icon-irr-sort-desc")).attr(ob,k).markup("></span><span class='u-vh'>").content(" "+k).markup("</span>"),g>1&&a.markup("<span aria-hidden='true'>").content(f.sortIndex).markup("</span>"),a.markup("</span>")),a.markup("</th>"));a.markup("</tr>")}var d,e,f,g,j=this,k=this.element,l=this.options,o=a.htmlBuilder(),p="<table role='presentation' class='"+M+"'>",q="<thead role='rowgroup'>",r="<span class='"+oa+" u-vh is-focusable' aria-hidden='true' tabindex='-1'></span>";for(f=this.lastFrozenColIndex>=0||l.rowHeader!==Wa,g=0,d=0;d<this.columns.length;d++)this.columns[d].sortDirection&&(g+=1);o.markup("<div class='"+C+"'>"),f&&(o.markup("<div class='"+G+"'>"+p),b(o,!0),o.markup(q),c(o,!0,!1),o.markup("</thead></table></div>")),o.markup("<div class='"+I+"'>"+p),b(o,!1),o.markup(q),c(o,!1,!1),o.markup("</thead></table></div></div><div class='"+E+"'>"),this._renderAltDataMessages(o,this.idPrefix),o.markup("<div class='u-vh'").attr("id",this.accContextId).markup("></div>"),f&&(o.markup(r+"<div class='"+G+"'>"+p),b(o,!0),o.markup(q),c(o,!0,!0),o.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(o),o.markup("</div>"+r+r)),o.markup("<div class='"+K+"' tabindex='-1'>"+p),b(o,!1),o.markup(q),c(o,!1,!0),o.markup("</thead><tbody></tbody></table>"),this._renderLoadMore(o),o.markup("</div>"),(f||l.autoAddRecord&&this.model.allowAdd())&&o.markup(r),o.markup("</div>"),l.editable&&o.markup("<div class='a-GV-floatingItem' tabindex='-1' style='display: none;'>").markup("<div class='a-GV-cellMoveHandle'></div>").markup("<button type='button' class='"+ua+"' tabindex='-1'><span aria-hidden='true' class='a-Icon'></span></button>"+r+"<div class='"+sa+"'></div>"+r+"</div>"),this._renderFooter(o,this.idPrefix),l.columnSort&&(o.markup("<div class='"+$+"' style='display:none'>"),this._renderButton(o,"a-Button js-asc","icon-up-chevron",m("SORT_ASCENDING")),this._renderButton(o,"a-Button js-desc","icon-down-chevron",m("SORT_DESCENDING")),o.markup("</div>")),l.reorderColumns&&o.markup("<div class='"+aa+"' style='display:none'></div>").markup("<div class='a-GV-colMoveMarker' style='display:none'>").markup("<span class='a-GV-colMoveMarker-x'></span></div>"),this.floatingItem$&&this.floatingItem$.remove(),k.html(o.toString()),this._updateAccLabel(),this.pageKey=null,e=k.find(".a-GV-table>tbody,.a-GV-table>thead"),f?(this.tableFrozenHeader$=e.eq(0),this.frozenColumnCount=this.tableFrozenHeader$.children().last().children().length,this.tableHeader$=e.eq(1),this.tableFrozenData$=e.eq(3),this.tableData$=e.eq(5)):(this.tableFrozenHeader$=null,this.frozenColumnCount=0,this.tableFrozenData$=null,this.tableHeader$=e.eq(0),this.tableData$=e.eq(2)),this._clearChildrenRowCache(),this.accContext$=h("#"+this.accContextId),this.columnControls$=k.find(_),this.columnControls$.find("button").attr(ub,-1),this.columnHandle$=k.find("."+aa),this.columnMoveMarker$=k.find(".a-GV-colMoveMarker"),this.floatingItem$=k.find(ra)},_updateAccLabel:function(){var a=this.origLabelBy;this.noData?a+=" "+this.idPrefix+"_msg":this.options.footer&&(a+=" "+this.idPrefix+"_pageRange "+this.idPrefix+"_status"),this.element.attr(Qa,a)},_calcSpanAllColumns:function(a){var b,c,d,e;for(c=0,a?(d=0,e=this.lastFrozenColIndex+1,this.options.rowHeader!==Wa&&(c+=1)):(d=this.lastFrozenColIndex+1,e=this.columns.length),b=d;b<e;b++)this.columns[b].hidden||(c+=1);return c},_getHeaderHeight:function(){return this.element.find(D).outerHeight()},_getStickyTop:function(){return h.isFunction(this.options.stickyTop)?this.options.stickyTop():0},_selectedCount:function(){var a=0,b=this.options;if(this.tableData$)return b.selectCells?(a=this.tableData$.find(ya).filter(R).length,this.tableFrozenData$&&(a+=this.tableFrozenData$.find(ya).filter(R).length)):a=b.persistSelection?this.model.getSelectedCount():this.tableData$.find("tr.is-selected").length,a},_selectedStatusMessage:function(){var a=this.options;return d.getMessage(a.selectCells?"APEX.GV.SELECTION_CELL_COUNT":a.selectionStatusMessageKey)},_deletedCount:function(){return this.tableData$.find(Ja).length},_hasControlBreaks:function(){return this.breakColumns.length>0},_getRecordHeight:function(){var a,b;return a=this.tableData$.find(Q).filter(Ta).first(),a.length?b=a.outerHeight():(a=h("<tr class='"+N+"'><td class='"+S+"'></td></tr>"),a=this.tableData$.append(a),b=a.outerHeight(),this.tableData$.empty()),b},_getDataRenderContext:function(){return{hasFrozenColumns:this.lastFrozenColIndex>=0||this.options.rowHeader!==Wa,dataOut:a.htmlBuilder(),frozenOut:a.htmlBuilder()}},_getDataContainer:function(){return this.tableFrozenData$?h([this.tableFrozenData$[0],this.tableData$[0]]):this.tableData$},_insertFiller:function(a,b){var c,d;return a.hasFrozenColumns&&(d=h(a.frozenOut.toString()),b?b.first().before(d):this.tableFrozenData$.html(d)),c=h(a.dataOut.toString()),b?b.last().before(c):this.tableData$.html(c),a.hasFrozenColumns&&(c=h([d[0],c[0]])),this._clearChildrenRowCache(),c},_insertData:function(a,b,c,d,e){var f,g,i,j,k,l=this;a.hasFrozenColumns&&(i=r(a.frozenOut)),g=r(a.dataOut),d?(a.hasFrozenColumns&&d.first()[e](i),d.last()[e](g)):(a.hasFrozenColumns&&this.tableFrozenData$.append(i),this.tableData$.append(g)),this._clearChildrenRowCache(),this.allSelected&&this.options.pagination.scroll&&(j=g.map(function(a,b){return h(b).children()[0]}),k=this.focusInHeader,this.focusInHeader=!1,this._select(j,"add",null,!1),this.focusInHeader=k),this.options.hasSize&&(f=this.element.children(F),this._adjustSizeForScrollBars(f.height(),f.find(L).width())),this.gotoCellPending&&setTimeout(function(){l.gotoCell(l.gotoCellPending.record,l.gotoCellPending.column)},1),this._trigger(gb,null,{offset:b,count:c})},_controlBreakLabel:function(b){var c,d,e,f,g=this.options,h="",i=[];for(c=0;c<this.breakColumns.length;c++)d=this.breakColumns[c],c>0&&(h+=", "),e=this.model.getValue(b,d.property),i[c]=e,null===e&&(e=""),"object"==typeof e&&e.hasOwnProperty("d")?e=e.d:(f=this.columnItems[d.property],f&&(e=f.item.displayValueFor(e))),""===e&&g.showNullAs&&(e=g.showNullAs),d.escape!==!1&&(e=a.escapeHTML(e)),(d.label||d.heading)&&(h+="<span class='a-GV-breakLabel'>"+(d.label?a.escapeHTML(d.label):d.heading)+":</span> "),h+="<span class='a-GV-breakValue'> "+e+"</span>";return{label:h,values:i}},_renderBreakRecord:function(a,b,c,d){var e=c.label;a.hasFrozenColumns&&(this._renderBreakRow(a.frozenOut,!0,b,e,d),b=!1),this._renderBreakRow(a.dataOut,!1,b,e,d),this.controlBreaks.push({offset:d+1,label:e,values:c.values}),this.controlBreaks.sort(p)},_renderFillerRecord:function(a,b){a.hasFrozenColumns&&a.frozenOut.markup("<tr class='"+b+"'><td ").attr(pb,this._calcSpanAllColumns(!0)).markup("></td></tr>"),a.dataOut.markup("<tr class='"+b+"'><td ").attr(pb,this._calcSpanAllColumns(!1)).markup("></td></tr>")},_renderRecord:function(a,b,c,d,e){a.hasFrozenColumns&&this._renderRow(a.frozenOut,b,c,d,e,!0),this._renderRow(a.dataOut,b,c,d,e,!1)},_insertRecord:function(b,c,d,e,f){function g(a){var g,h,i;j._renderRow(l,c,null,d,e,a),g=r(l),m.push(g[0]),"after"===f&&b?(h=a?b.first():b.last(),h.after(g)):(i=a?j.tableFrozenData$:j.tableData$,i.prepend(g))}var i,j=this,k=this.lastFrozenColIndex>=0||this.options.rowHeader!==Wa,l=a.htmlBuilder(),m=[];return!b&&j._hasControlBreaks()&&(i=h(this.lastFocused).closest("."+ka),i.length||(i=this.tableData$.find("."+ka).first()),1===i.length&&this.tableFrozenHeader$&&(b=i.add(this._getOtherTable(i)[this._rowIndex(i)])),b&&this._expandCollapseControlBreak([b],!0),f="after"),k&&(g(!0),l.clear()),g(!1),this._clearChildrenRowCache(),h(m)},_afterInsert:function(a,b){var c,d,e,f,g,i,j=this,k=!!this.element.find("."+za).length||h(document.activeElement).hasClass(qa),l=a[0].find(".a-GV-cell").first();for(c=0;c<this.columns.length;c++)if(d=this.columns[c],!d.hidden&&!d.readonly&&this.columnItems[d.property]){l=v(a[0],this.fieldToColumnIndex[d.property]);break}if(this._hasControlBreaks()&&!b&&a[0]&&(f=a[0].prev().attr(sb),null!=f))for(e=this._getControlBreak(parseInt(f,10)),g=this.model.getRecord(a[0].attr("data-id")),i=e.values,c=0;c<this.breakColumns.length;c++)d=this.breakColumns[c],this.model.setValue(g,d.property,i[c]);setTimeout(function(){j._select(l,null,k,!1,!1),k&&j.options.editable&&!j.editMode&&j.setEditMode(!0)},1)},_updateRecordField:function(b,c,d,e){var f,g,h,i,j=this.fieldToColumnIndex[d],k=a.htmlBuilder();void 0!==j&&(f=v(b,j),this.editMode&&c===this.activeRecord&&!this.ignoreItemChange&&(g=this.columnItems[d],g&&this._setColumnItemValue(g.item,c,d)),f.hasClass(Ea)||(h=this.options.columns[0][d],i=null,e.fields&&(i=e.fields[h.property]),k=a.htmlBuilder(),this._renderFieldDataValue(k,h,c,e,i),f.html(k.toString())))},_updateRecordState:function(a,b,c,d){var e,f,g,h,i,j=this.options,m=!this.tooltipOptions;if(h=k(d,j,a.hasClass(xa),this.model,c),a.attr("class",h),m&&(d.message?a.first().find(ga).attr(ob,d.message):a.first().find(ga).removeAttr(ob)),d.fields)for(e in d.fields)if(d.fields.hasOwnProperty(e)){if(f=d.fields[e],i=this.fieldToColumnIndex[e],void 0===i)continue;g=v(a,i),h=l(j.columns[0][e],d,f,j,g,this.model,c),g.attr("class",h),m&&(f.message&&!d.deleted?g.attr(ob,f.message):g.removeAttr(ob))}},_removeRecord:function(a){a.remove()},_identityChanged:function(a,b){var c=this._elementsFromRecordIds([a])[0];c.attr(rb,b),this.activeRecordId===a&&(this.activeRecordId=b)},_replaceRecord:function(b,c,d,e,f){var g,i,j,k,l,m,n,o,p=null,u=null,w=[],x=b.first().children().first().find(".a-GV-rownum").text()||null,y=this.lastFrozenColIndex>=0||this.options.rowHeader!==Wa,z=a.htmlBuilder();x&&(x=parseInt(x,10)-1),this.activeRecordId===d&&(this.activeRecord=this.activeRecordId=null),i=b.hasClass(xa),j=b.find(this.lastFocused).length,j&&(o=this.lastFocused,l=s(o).hasClass(za)),k=b.find(this.lastEditModeCell).length&&h(this.lastEditModeCell).hasClass(za),k&&(o=this.lastEditModeCell),o&&(p=0,u=q(t(o))),y&&(o&&b.last().find(o).length&&(p=1),this._renderRow(z,c,x,e,f,!0),g=r(z),w.push(g[0]),b.first().replaceWith(g),z.clear()),this._renderRow(z,c,x,e,f,!1),g=r(z),w.push(g[0]),b.last().replaceWith(g),this._clearChildrenRowCache(),g=h(w),i&&g.add(g.find(".a-GV-selHeader .u-selector")).addClass(xa).attr(La,!0),k?this._activateCell(v(g.eq(p),u)):j&&(n=v(g.eq(p),u),m=this._getCellFocusable(n),this._setFocusable(m),this._setCurrentRow(n[0]),l&&this._setFocus(m))},_removeFocus:function(a){var b,c,d;b=h(this.lastFocused).closest(Q),(b[0]===a[0]||a.length>1&&b[0]===a[1])&&(c=u(this.lastFocused),d=this._getNextCellDown(c,1),d||(d=this._getPrevCellUp(c,1)),d&&this._select(d,null,!0,!1))},_elementsFromRecordIds:function(a){var b,c,d=!0,e=[],f={};for(b=0;b<a.length;b++)f[a[b]]=b,e[b]=null;return this.tableFrozenData$||(d=!1),d&&(c=this.tableFrozenData$.children()),this.tableData$.children().each(function(a){var b=h(this),g=b.attr(rb);void 0!==f[g]&&(d?e[f[g]]=h([c[a],this]):e[f[g]]=b)}),e},_renderBreakRow:function(a,b,c,d,e){var f;f=this._calcSpanAllColumns(b),a.markup("<tr role='row' class='"+ka+" is-expanded'").optionalAttr(sb,null!=e?e+1:null).markup("><th role='rowheader' class='a-GV-controlBreakHeader'").attr(pb,f).markup(">"),c&&this.options.collapsibleControlBreaks&&this._renderButton(a,"a-Button js-toggleBreak","icon-down-arrow",m("BREAK_COLLAPSE")),a.markup("<span class='a-GV-controlBreakLabel'>").markup(d).markup("</span></th></tr>")},_getControlBreak:function(a){var b,c=null;return this.breakColumns.length>0&&(b=o(this.controlBreaks,{offset:a},p),c=this.controlBreaks[b],c&&c.offset===a||(c=this.controlBreaks[b-1])),c},_renderRow:function(a,b,c,d,e,f){var g,h,i,j,n,o,p,q=null,r=null,s=null,t=this.options,u=this.columns,v=this.lastFrozenColIndex+1,w=u.length,x=!this.tooltipOptions;for(i=k(e,t,null,this.model,b),e.agg?q=e.grandTotal?t.aggregateLabels[e.agg].overallLabel:t.aggregateLabels[e.agg].label:!e.deleted&&e.message&&x&&(r=e.message),o=void 0!==e.serverOffset?e.serverOffset+1:"",a.markup("<tr role='row'").attr(rb,d).optionalAttr(sb,o).attr("class",i).optionalAttr(ob,q).optionalAttr(La,e.sel?Za:null).optionalAttr("style",this.controlBreakCollapsed?"display:none;":null).markup(">"),f&&t.rowHeader!==Wa&&(p=e.agg||t.rowHeader===Ya,a.markup("<th role='rowheader'").attr("class",S+" "+fa+(p?" "+ba:"")).optionalAttr(ob,r).markup(">"),e.agg||(t.rowHeaderCheckbox&&(j=t.multiple?ca:da,e.sel&&(j+=" "+xa),a.markup("<span class='"+j+"'").attr("title",m("SELECT_ROW")).markup("></span>")),t.rowHeader===Xa&&a.markup("<span class='a-GV-rownum' aria-hidden='true'>").content(o).markup("</span>")),p&&(a.markup("<span class='a-GV-rowLabel'>"),e.agg?a.content(t.aggregateLabels[e.agg][e.grandTotal?"overallLabel":"label"]):t.rowHeaderLabelColumn&&a.markup(this.model.getValue(b,t.rowHeaderLabelColumn)),a.markup("</span>")),a.markup("</th>")),f&&(v=0,w=this.lastFrozenColIndex+1),g=v;g<w;g++)h=u[g],n=null,e.fields&&(n=e.fields[h.property]),h.hidden||(i=l(h,e,n,t,null,this.model,b),s=null,x&&(n&&n.message?s=n.message:e.agg&&(s=t.aggregateTooltips[e.agg+"|"+h.property])),a.markup("<td role='gridcell' tabindex='-1'").attr("class",i).optionalAttr(ob,s).markup(">"),this._renderFieldDataValue(a,h,b,e,n),a.markup("</td>"));a.markup("</tr>")},_getColumnMetadata:function(a){var b,c,d;if(a.hasClass(S))b=q(a),c=a.closest(H).length?this.tableFrozenHeader$:this.tableHeader$,d=c.children().last().children().eq(b);else{if(!a.hasClass(V))return null;d=a}return b=parseInt(d.attr(qb),10),isNaN(b)?null:this.columns[b]},_activateColumnHeader:function(a,b){var c=this._getColumnMetadata(b);c.noHeaderActivate||this._trigger(eb,a,{
header$:b,column:c})},_activateRow:function(a){var b,c,d,e,f,g,h,i=a.parent(),j=i.attr(rb),k=this;for(e=this.model.getRecord(j),f=this.model.getRecordId(e),h=this.model.allowEdit(e),g=this.model.getRecordMetadata(f),i.addClass(Ea),this._beginSetColumnItems(),b=0;b<this.columns.length;b++)d=this.columns[b].property,c=this.columnItems[d],c&&this._setColumnItemValue(c.item,e,d,h?g:null);this.activeRecord=e,this.activeRecordId=f,this._endSetColumnItems(),setTimeout(function(){k._triggerBeginEditing(k.activeRecord,k.activeRecordId)},1)},_deactivateRow:function(a){var b,c,d,e,f,g,h,i=this.element.find(".a-GV-row.is-active");if(this.activeLockCount>0)return void(this.activeUnlockCallback=a);if(i.removeClass(Ea),f=this.model.getRecordMetadata(this.activeRecordId),f&&!f.deleted&&this.model.allowEdit(this.activeRecord))for(b=0;b<this.columns.length;b++)d=this.columns[b].property,c=this.columnItems[d],c&&(h=c.item.isDisabled(),h?this.model.setValidity("valid",this.activeRecordId,d):(e=c.item.getValidity(),e.valid||this.model.setValidity("error",this.activeRecordId,d,c.item.getValidationMessage())),g=f.fields?f.fields[d]:null,(g&&g.hasOwnProperty("disabled")||h)&&(g||(f.fields||(f.fields={}),g={},f.fields[d]=g),g.disabled=h));this._triggerEndEditing(this.activeRecord,this.activeRecordId),this.activeRecord=null,this.activeRecordId=null,a()},_beginDeactivate:function(a,b){var c=this;this.deactivateDelayTimer||(this.deactivateDelayTimer=setTimeout(function(){c.lastEditModeCell=null,c._deactivateCell(a),b&&(c.dontFocusEditableItem=!0,a.focus()),c.deactivateDelayTimer=null},10))},_clearDeactivate:function(){this.deactivateDelayTimer&&(clearTimeout(this.deactivateDelayTimer),this.deactivateDelayTimer=null)},_setTabTraps:function(a){var b,c,d,e,f,g=this.options.autoAddRecord&&this.model.allowAdd(),h=this.tabTraps$;a.attr(ub,-1),b=this._nextCellWithWrap(a).attr(ub,0),c=this._prevCellWithWrap(a).attr(ub,0),e=null,this.tableFrozenData$?(e=3,d=5,h.eq(0).prop(tb,c.length?0:-1),f=1===a.parent().children().length,h.eq(1).prop(tb,f?0:-1),h.eq(2).prop(tb,f?0:-1)):g?(e=0,d=2):d=1,null!==e&&(g&&this.onLastPage&&0===b.length?h.eq(e).prop(tb,0).addClass(qa):h.eq(e).prop(tb,b.length?0:-1).removeClass(qa)),g&&this.onLastPage&&0===b.length?h.eq(d).prop(tb,0).toggleClass("js-last",!b.length).addClass(qa):h.eq(d).prop(tb,b.length?0:-1).toggleClass("js-last",!b.length).removeClass(qa)},_clearTabTraps:function(){this.element.find(".a-GV-cell[tabindex='0'],.a-GV-controlBreakHeader[tabindex='0']").attr(ub,-1),this.tabTraps$.prop(tb,-1)},_activateCell:function(a,b){function c(a){b=b||g._getCellFocusable(a),b!==a[0]&&b.focus()}function d(){e=g._getColumnMetadata(a),e&&(j=g.columnItems[e.property]),j&&g.model.allowEdit(g.activeRecord)&&!e.readonly&&!a.hasClass(Ia)?(a.addClass(Ea),f=j.item.getPopupSelector(),f&&h(document.body).on("focusin.gridpopup",function(a){h(a.target).closest(f).length&&g._clearDeactivate()}).on("focusout.gridpopup",function(a){var b;h(a.target).closest(f).length&&(b=h(g.lastEditModeCell),g._beginDeactivate(b,!0))}),j.element$.height()>a.height()?(a.empty(),g.floatingItem$.children(ta).append(j.element$),g._expandFloatingItem(a)):a.empty().append(j.element$),g._activateColumnItem(j,e.domId),g.dontFocusEditableItem||j.item.setFocus(),g.dontFocusEditableItem=!1,i=!0):c(a)}var e,f,g=this,i=!1,j=null,k=a.hasClass(la);if(this.lastEditModeCell=a[0],a.parent().hasClass(xa)?this.lastRow$&&this.lastRow$.index(a)>=0||this._setCurrentRow(a[0]):this._select(a,null,!1,!1),this._setFocusable(a[0]),this._setTabTraps(a),!this.activeRecord||this.activeRecordId!==a.parent().attr(rb)){if(this.activeRecord)return void this._deactivateRow(function(){k?c(a):(g._activateRow(a),d())});k?c(a):this._activateRow(a)}return k?c(a):d(),i},_expandFloatingItem:function(a){var b,c,d,e=this.element.hasClass(Sa)?"right top":"left top",f=a.outerWidth(),g=this._getColumnMetadata(a).property;this.floatingItem$.css("position","").css("min-width",f+"px").appendTo(nb).show().addClass(Da).draggable("enable").attr("data-owning-region",this.element[0].id).find(va+" span").removeClass("icon-ig-expand").addClass("icon-ig-restore"),this.floatingItem$.children(ta).show().css({width:"",height:""}),d=this.lastFloatingPos[g],d?this.floatingItem$.css({left:d.left,top:d.top}):this.floatingItem$.position({my:e,at:e,of:a,collision:"fit fit"}),this.floatingItem$.find(pa).not(".js-last").attr(ub,0),b=this._getColumnMetadata(a),b&&(c=this.columnItems[b.property],c.item.setFocus())},_collapseFloatingItem:function(a){var b=a.innerWidth(),c=a.innerHeight();this.floatingItem$.css({position:"relative",left:"",top:""}).appendTo(a).draggable("disable").removeClass(Da+" ui-state-disabled").removeAttr("data-owning-region").find(va+" span").removeClass("icon-ig-restore").addClass("icon-ig-expand"),this.floatingItem$.children(ta).hide().width(b).height(c),this.floatingItem$.find(va).focus(),this.floatingItem$.find(pa).not(".js-last").attr(ub,-1)},_deactivateCell:function(b){var c,d,e,f,g=null;b.length<=0||(this._clearTabTraps(),this._setFocusable(b[0]),c=this._getColumnMetadata(b),c&&(g=this.columnItems[c.property]),g&&b.hasClass(Ea)&&(h(document.body).off(".gridpopup"),this._setModelValue(b,g.item,this.activeRecord,c.property),e=this.model.getRecordMetadata(this.activeRecordId),f=null,e.fields&&(f=e.fields[c.property]),this.debugDontDeactivateCell?b.addClass(za+" "+Ea):(this.floatingItem$.appendTo(nb),this.floatingItem$.hide(),this._deactivateColumnItem(g),d=a.htmlBuilder(),this._renderFieldDataValue(d,c,this.activeRecord,e,f),b.html(d.toString())),this._updateRecordState(this.lastRow$.parent(),this.activeRecordId,this.activeRecord,e)))},_finishEditing:function(a){var b,c=h(this.lastEditModeCell);c.length&&(b=c.hasClass(za),this._clearDeactivate(),this._deactivateCell(c),b&&this._activateCell(c)),a.resolve()},_setFocus:function(a){a.tabIndex=0,a.focus()},_setFocusable:function(a){function b(a){var b,c,d,e;for(b=0;b<t.columnGroups.length;b++)for(d=t.columnGroups[b],c=0;c<d.length;c++)if(e=d[c],e.property===a)return e;return null}var c,d,e,f,g,i,j,k,l,o,p,q,r,t=this,u=this.options.tabbableCellContent,v=s(a);if(this.lastFocused&&(h(this.lastFocused).removeAttr(Qa).closest(R).removeAttr("id"),d=s(this.lastFocused),v[0]!==d[0]&&d.add(d.find(u).not(Va)).prop(tb,-1)),q=v.closest(Q),k=q.attr(sb),l=null,(v.hasClass(la)||v.hasClass(X))&&(l=this.lastColIndex),null===l&&(l=w(v)),this.tableFrozenHeader$&&!v.closest(Q).closest(P).parent().hasClass(G)&&(l+=this.frozenColumnCount),l+=1,q.hasClass(ka)?o=m("BREAK_CONTEXT"):q.hasClass(Ka)?o=m("AGG_CONTEXT"):v.hasClass(V)?o=m("HEADER_CONTEXT"):v.hasClass(X)?o=m("GROUP_CONTEXT"):(k!==this.curRowNum&&l!==this.curColNum?o=n("ROW_COLUMN_CONTEXT",k,l):k!==this.curRowNum?o=n("ROW_CONTEXT",k):l!==this.curColNum&&(o=n("COLUMN_CONTEXT",l)),r=this._getControlBreak(parseInt(k,10)),r&&r.offset!==this.curControlBreak&&(o+=" "+m("BREAK_CONTEXT")+" "+r.label+".")),o&&this.accContext$.text(o),e=0,v.children(".a-GV-columnItem")[0]||(e=v.find(u).not(Va).prop(tb,0).length),e||v.prop(tb,0),this.lastFocused=a,f="",k!==this.curRowNum&&(this.curRowHeaders&&h(this.curRowHeaders).removeAttr("id"),this.curRowHeaders="",q=this._getRowForCell(v),q.find("."+ba).not(v).each(function(a){var b=t.idPrefix+"_rh_"+a;h(this).attr("id",b),f+=b+" ",t.curRowHeaders&&(t.curRowHeaders+=","),t.curRowHeaders+="#"+b})),l!==this.curColNum&&!this.focusInHeader)if(c=this._getColumnMetadata(v),c&&c.domId){for(g="",i=z(c);i;)j=b(i),j&&j.domId&&(g=j.domId+" "+g),i=j.parentGroupName;g+=c.domId,f+=g+" "}else v.hasClass(fa)&&(f+=this.idPrefix+"_shh ");p=this.idPrefix+"_cur",f+=p,f=this.accContextId+" "+f,h(a).attr(Qa,f).closest(R).attr("id",p),this.curRowNum=k,this.curColNum=l,this.curControlBreak=r?r.offset:null},_getCellFocusable:function(a){var b=a.find(this.options.tabbableCellContent).not(Va);return b.length?b[0]:a[0]},_getPrevCellUp:function(a,b,c){var d,e=null,f=null;return(a.hasClass(la)||a.hasClass(X))&&(f=this.lastColIndex),null===f&&(f=w(a),this.lastColIndex=f),a.closest(Q).prevAll(Ta).each(function(a){var c=h(this);return!c.hasClass(U)&&(d=c,a<b-1)}),this.focusInHeader||c||d||(this.focusInHeader=!0,d=a.closest(Q).closest(P).parent().hasClass(G)?this.tableFrozenHeader$.children().last():this.tableHeader$.children().last()),d&&(e=d.hasClass(ka)?d.children().first():v(d,f)),e},_getNextCellDown:function(a,b){var c,d=null,e=null;return(a.hasClass(la)||a.hasClass(X))&&(e=this.lastColIndex),null===e&&(e=w(a),this.lastColIndex=e),a.closest(Q).nextAll(Ta).each(function(a){var d=h(this);return!d.hasClass(U)&&(c=d,a<b-1)}),this.focusInHeader&&!c&&(this.focusInHeader=!1,c=a.closest(Q).closest(P).parent().hasClass(G)?this.tableFrozenData$.children().first():this.tableData$.children().first()),c&&(d=c.hasClass(ka)?c.children().first():v(c,e)),d},_copy:function(a){var b,c,d,e,f,g,h,i,j,k,l=this.model,m=this.options,n=m.dataTransferFormats;if(m.selectCells){if(i=[],d=this.getSelectedRange(),!d||!d.values.length)return;for(i=d.columns.map(function(a){return a?m.columns[0][a]:null}),n.forEach(function(a){a.writer.begin(l,d,i)}),b=0;b<d.values.length;b++){for(j=d.recordIds[b],h=null!==j?l.getRecord(j):null,n.forEach(function(a){a.writer.beginRow(b,h,j)}),g=d.values[b],c=0;c<g.length;c++)k=h&&i[c]?l.getValue(h,i[c].property):"",n.forEach(function(a){a.writer.cell(c,i[c],k,g[c])});n.forEach(function(a){a.writer.endRow()})}}else{if(d=this.getSelection(),!d.length)return;for(i=[],"NONE"!==m.rowHeader&&i.push(null),this.getColumns().forEach(function(a){a.hidden||i.push(a)}),n.forEach(function(a){a.writer.begin(l,d,i)}),b=0;b<d.length;b++){for(e=d[b],j=e.first().attr(rb),h=null!==j?l.getRecord(j):null,n.forEach(function(a){a.writer.beginRow(b,h,j)}),f=e.children(),c=0;c<f.length;c++)k=h&&i[c]?l.getValue(h,i[c].property):"",n.forEach(function(a){a.writer.cell(c,i[c],k,f.eq(c).text())});n.forEach(function(a){a.writer.endRow()})}n.forEach(function(a){a.writer.end()})}n.forEach(function(b){b.writer.end(),a.setData(b.format,b.writer.toString())})},_setSelectionMode:function(){var a=this.options,b=this.element.children(F).find(ya);this.element.toggleClass("a-GV--selectCells",a.selectCells),b.removeClass(xa).removeAttr(La),a.persistSelection&&this.model.clearSelection(),this.allSelected=!1,this.lastFocused&&b[0]&&this._select(h(this.lastFocused),null,!1)},_select:function(b,c,d,e,f){function g(a,b){var c;K.persistSelection&&(c=a.length,M.tableFrozenHeader$&&(c/=2),a.each(function(a){var d;return!(a>=c)&&(d=h(this).attr(rb),void(b&&z[d]===!1?delete z[d]:z[d]=b))}))}function i(a,b){var c=h(b);return!(a>m)&&void(a>=l&&c.hasClass(N)&&!c.hasClass(Ka)&&(K.allowSelectHidden||c.is(Ta))&&c.children().slice(E,G).addClass(xa).attr(La,!0))}function j(a,b){var c=h(b);c.hasClass(N)&&!c.hasClass(Ka)&&(K.allowSelectHidden||c.is(Ta))&&x.push(b)}var k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,E,G,H,I,J=!1,K=this.options,L="set",M=this;if(K.persistSelection&&(z={}),"unset"===c||K.allowSelectHidden||(b=b.filter(Ta)),s=b.parent(Q),A=this.lastRow$&&this.lastRow$.index(b.first())>=0,this.tableFrozenHeader$&&(x=[],w=M._getOtherTable(s.first()),s.each(function(){x.push(w[M._rowIndex(h(this))])}),s=s.add(h(x))),c&&(K.selectCells&&K.multipleCells||!K.selectCells&&K.multiple)&&("string"==typeof c?L=c:"click"===c.type?c.ctrlKey||c.metaKey?L="toggle":c.shiftKey&&(L="range"):"keydown"===c.type&&(c.which===vb.SPACE?L=c.ctrlKey?"toggle":c.shiftKey?"range":"add":c.ctrlKey?L="none":c.shiftKey&&(L="range")),K.selectCells&&"range"!==L&&(L="set"),c.target||(c=null)),"range"!==L||this.selectAnchor&&!this.focusInHeader||(L="set"),!this.focusInHeader)if("set"!==L&&"range"!==L||(H=this.element.children(F).find(K.selectCells?"td.is-selected,th.is-selected":"tr.is-selected"),K.rowHeaderCheckbox&&H.find(ea).removeClass(xa),H.removeClass(xa).removeAttr(La),K.persistSelection&&this.model.clearSelection()),K.selectCells)"range"===L?(B=h(this.selectAnchor),l=q(B.parent()),m=q(b.last().parent()),l>m&&(p=m,m=l,l=p),n=q(B),C=this.tableFrozenData$&&B.closest(this.tableFrozenData$).length>0,o=q(b.last()),D=this.tableFrozenData$&&b.last().closest(this.tableFrozenData$).length>0,(C===D&&n>o||C!==D&&!C)&&(p=o,o=n,n=p,p=D,D=C,C=p),this.tableData$&&!D&&(E=n,G=o+1,C!==D&&(E=0),this.tableData$.children().each(i)),C&&this.tableFrozenData$&&(E=n,G=o+1,C!==D&&(G=void 0),this.tableFrozenData$.children().each(i))):(b.addClass(xa).attr(La,!0),this.selectAnchor=b[0]);else if(k=s.hasClass(xa),t=s.filter(O).not("."+Ka),"set"===L||"add"===L||"toggle"===L&&!k?(t.addClass(xa).attr(La,!0),this.selectAnchor=t[0],J=!0):"range"===L?(l=this._rowIndex(h(this.selectAnchor)),m=this._rowIndex(s.last()),l>m&&(p=m,m=l,l=p),m+=1,x=[],this.tableDataChildren$.slice(l,m).each(j),this.tableFrozenData$&&this.tableFrozenDataChildren$.slice(l,m).each(j),t=h(x),t.addClass(xa).attr(La,!0),J=!0):("toggle"===L&&k||"unset"===L)&&(t.removeClass(xa).removeAttr(La),this.selectAnchor=t[0],K.rowHeaderCheckbox&&t.find(ea).removeClass(xa),g(t,!1)),J&&(K.rowHeaderCheckbox&&t.find(ea).addClass(xa),g(t,!0)),K.multiple&&K.selectAll&&(u=(this.tableFrozenData$||this.tableData$).children(O).not("."+Ka),K.allowSelectHidden||(u=u.filter(Ta)),this.allSelected=v=u.length>0&&u.length===u.filter(ya).length,K.rowHeaderCheckbox&&this.tableFrozenHeader$.find(ea).first().toggleClass(xa,v).attr(Ra,v?Za:$a).closest(ga).toggleClass(xa,v)),K.persistSelection)for(y in z)z.hasOwnProperty(y)&&this.model.setSelectionState(y,z[y]);b.length>0&&null!==d&&(r=this._getCellFocusable(b.first()),d?this._setFocus(r):this._setFocusable(r),A||this._setCurrentRow(b[0])),this.focusInHeader||"toggle"!==L&&"unset"!==L&&("range"!==L||!K.selectCells&&k)&&("add"!==L||k)&&("set"!==L||!K.selectCells&&a.arrayEqual(H,t))||(I=!(f||K.navigation&&c&&"click"===c.type),e?Eb(this,I,c):Db(this,I,c))},_clearChildrenRowCache:function(){this.tableFrozenDataChildren$=this.tableDataChildren$=null},_getOtherTable:function(a){var b,c=a.closest(P).parent().hasClass(G);return a.parents(F).length?c?(this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),b=this.tableDataChildren$):(this.tableFrozenDataChildren$||(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),b=this.tableFrozenDataChildren$):b=(c?this.tableHeader$:this.tableFrozenHeader$).children(),b},_rowIndex:function(a){var b,c=a.closest(P).parent().hasClass(G);return a.parents(F).length?(this.tableFrozenData$&&!this.tableFrozenDataChildren$&&(this.tableFrozenDataChildren$=this.tableFrozenData$.children()),this.tableDataChildren$||(this.tableDataChildren$=this.tableData$.children()),b=c?this.tableFrozenDataChildren$:this.tableDataChildren$,b.index(a)):q(a)},_getRowForCell:function(a){var b=a.closest(Q);return this.tableFrozenHeader$&&(b=b.add(this._getOtherTable(b).eq(this._rowIndex(b)))),b},_setCurrentRow:function(a){this.lastRow$=this._getRowForCell(h(a)).children()},_fireActivate:function(a,b){var c=this._getRowForCell(b);this._trigger(hb,a,{cell$:b,row$:c})},_nextCellWithWrap:function(a){function b(a){for(;e&&a.hasClass(Ka)||a.not(Ta).length;)a=a.next();return a.children().first()}function c(a){var c,d,e,g=a.next();return g.length||(c=a.closest(Q),f.tableFrozenHeader$?(d=f._getOtherTable(c),e=f._rowIndex(c),c.closest(P).parent().hasClass(G)?g=d.eq(e).children().first():(c=d.eq(e+1),g=b(c))):(c=c.next(),g=b(c))),g}var d,e=this.options.skipReadonlyCells,f=this;if(d=c(a),e)for(;d.hasClass(Ia);)d=c(d);return d},_prevCellWithWrap:function(a){function b(a){for(;e&&a.hasClass(Ka)||a.not(Ta).length;)a=a.prev();return a.children().last()}function c(a){var c,d,e,g=a.prev();return g.length||(c=a.closest(Q),f.tableFrozenHeader$?(d=f._getOtherTable(c),e=f._rowIndex(c),c.closest(P).parent().hasClass(G)?(e-=1,e>=0&&(c=d.eq(e),g=b(c))):g=d.eq(e).children().last()):(c=c.prev(),g=b(c))),g}var d,e=this.options.skipReadonlyCells,f=this;if(d=c(a),e)for(;d.hasClass(Ia);)d=c(d);return d},_clearHoverStates:function(){this.element.find(Ba).removeClass(Aa),this.columnControls$.hide(),this.columnHandle$.hide()},_setRowHoverState:function(a){this.element.find(Ba).removeClass(Aa),a=this._getRowForCell(a.children().eq(0)),a.addClass(Aa)},_sortChange:function(a,b,c){var d,e="set",f=this._getColumnMetadata(b);f.canSort&&(d=c===f.sortDirection,this.options.columnSortMultiple&&a.shiftKey?(e="add",e=d?"remove":f.sortDirection?"change":"add"):d&&(e="clear"),this._trigger(bb,a,{header$:b,column:f,direction:c,action:e}))},_updateColumnControls:function(a){var b,c,d=!1,e=!1;"asc"===a.sortDirection?(b=m("SORT_OFF"),c=m("SORT_DESCENDING"),d=!0):"desc"===a.sortDirection?(b=m("SORT_ASCENDING"),c=m("SORT_OFF"),e=!0):(b=m("SORT_ASCENDING"),c=m("SORT_DESCENDING")),this.columnControls$.find(".js-asc").attr(ob,b).attr(Oa,b).toggleClass(Ea,d),this.columnControls$.find(".js-desc").attr(ob,c).attr(Oa,c).toggleClass(Ea,e)},_adjustSizeForScrollBars:function(b,c,d){var e=this.element.children(),f=e.filter(F).children(H),g=e.filter(D).children(J),h=A(this.tableData$.parent(),d);h.h&&(b-=a.getScrollbarSize().height),f.height(b),h.v&&(c-=a.getScrollbarSize().width),g.width(c)},_headerScrollCheck:function(a,b,c){var d,e,f,g=0,i=this.hdrScrollParent;return i&&(f=h(this.hdrScrollParent).offset().left,this.element.hasClass(Sa)?(a-b-f<lb?g=-mb:f+i.offsetWidth-a<lb&&f+i.offsetWidth-a>0&&(g=mb),c&&g&&(d=i.scrollLeft+g,d>0?(i.scrollLeft=0,g=0):d>i.scrollWidth-i.clientWidth?(i.scrollLeft=i.scrollWidth-i.clientWidth,g=0):i.scrollLeft=d)):(f+i.offsetWidth-(a+b)<lb?g=mb:a-f<lb&&a-f>0&&(g=-mb),c&&g&&(d=i.scrollLeft+g,d<0?(i.scrollLeft=0,g=0):d>i.scrollWidth-i.clientWidth?(i.scrollLeft=i.scrollWidth-i.clientWidth,g=0):i.scrollLeft=d)),e=!!g),e},_headerScrollStart:function(a,b,c){function d(){e.scrollTimerId=setTimeout(function(){e._headerScrollCheck(a,b,!0)?(c(),d()):e._headerScrollStop()},g[f]),f<g.length-1&&(f+=1)}var e=this,f=0,g=[151,134,119,106,95,86,79,74,71];this.scrollTimerId&&this._headerScrollStop(),d()},_headerScrollStop:function(){clearTimeout(this.scrollTimerId),this.scrollTimerId=null},_expandCollapseControlBreak:function(a,b){function c(a,c){var d=h(c);return!(!d.hasClass(N)||d.hasClass(Ka))&&(!b&&k&&d.hasClass(xa)&&j.push(d.children(R)[0]),void d[b?"show":"hide"]())}var d,e,f,g,i,j=[],k=!this.options.allowSelectHidden;for(h.isArray(a)||(a=[a]),d=0;d<a.length;d++)e=a[d],e.hasClass(ka)&&(2!==e.length&&this.tableFrozenHeader$&&(f=this._getOtherTable(e),e=h([e[0],f[this._rowIndex(e)]])),e.first().nextAll().each(c),k=!1,2===e.length&&e.last().nextAll().each(c),b?(g=m("BREAK_COLLAPSE"),e.addClass(Da).find(".js-toggleBreak").attr(Pa,Za).attr(ob,g).attr(Oa,g).children(".a-Icon").removeClass("icon-right-arrow").addClass("icon-down-arrow")):(g=m("BREAK_EXPAND"),e.removeClass(Da).find(".js-toggleBreak").attr(Pa,$a).attr(ob,g).attr(Oa,g).children(".a-Icon").removeClass("icon-down-arrow").addClass("icon-right-arrow")));j.length&&(i=this.focusInHeader,this.focusInHeader=!1,this._select(h(j),"unset",h(document.activeElement).closest(this.element[0]).length>0,null),this.focusInHeader=i)},debugCellEdit:function(a){this.debugDontDeactivateCell=!!a}},apex.widget.contextMenuMixin)),h.ui.dialog&&h.widget("ui.dialog",h.ui.dialog,{_allowInteraction:function(a){return h(a.target).closest(ra).length>0||this._super(a)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.clipboard,apex.widget.util,apex.jQuery);
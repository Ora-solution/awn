!function(a,b,c,d,e,f){"use strict";function g(a){return d.getMessage("APEX.GV."+a)}function h(a){var b=Array.prototype.slice.call(arguments);return b[0]="APEX.GV."+a,d.formatMessage.apply(d,b)}function i(a,b){return Math.floor(a/b)*b}var j="a-GV-noDataMsg",k="a-GV-moreDataMsg",l="a-GV-altMessage",m="."+l,n=l+"-text",o="."+n,p=l+"-icon",q="a-GV-footer",r="a-GV--hideDeleted",s="a-GV-scrollFiller",t="."+s,u="is-deleted",v="."+u,w="aria-selected",x="is-active",y="is-selected",z="is-expanded",A="."+y,B="aria-labelledby",C="js-tabbable",D="."+C,E=":tabbable",F="data-start",G="data-end",H="disabled",I=300,J="apexbeginrecordedit",K="apexendrecordedit",L={};f.widget("apex.tableModelViewBase",{version:"19.1",widgetEventPrefix:"tableModelViewBase",options:{modelName:null,noDataMessage:null,moreDataMessage:null,editable:!1,autoAddRecord:!1,hasSize:!1,progressOptions:null,stickyFooter:!1,pagination:{scroll:!1,loadMore:!1,showPageLinks:!1,maxLinks:5,showPageSelector:!1,showRange:!0,firstAndLastButtons:!1},highlights:{},highlighter:null,highlighterContext:null,rowsPerPage:null,selectionStatusMessageKey:"APEX.GV.SELECTION_COUNT",hideDeletedRows:!1,footer:!0,scrollParentOverride:null},firstPage:function(){var a;return!this.renderInProgress&&(this.options.pagination.scroll?(a=this.scrollParent$,a.scrollTop(this.scrollDelta)):this.pageOffset>0&&(this.pageOffset=0,this.refresh(!1)),!0)},previousPage:function(){var a,b;return!this.renderInProgress&&(this.options.pagination.scroll?(a=this.scrollParent$,b=a.scrollTop()-this.scrollDelta-this.displayPageHeight,b<0&&(b=0),a.scrollTop(b+this.scrollDelta)):this.pageOffset>0&&(this.pageOffset-=this.pageSize,this.pageOffset<0&&(this.pageOffset=0),this.refresh(!1)),!0)},nextPage:function(){var a,b,c,d;return!this.renderInProgress&&(this.options.pagination.scroll?(a=this.scrollParent$,b=this._getDataContainer().first().height()-this.displayPageHeight,c=a.scrollTop()-this.scrollDelta+this.displayPageHeight,c>b&&(c=b),a.scrollTop(c+this.scrollDelta)):(d=this.model.getTotalRecords(),(d<0||this.pageOffset+this.pageCount<d)&&(this.pageOffset+=this.pageSize,this.refresh(!1))),!0)},lastPage:function(){var a,b,c,d;return!this.renderInProgress&&(this.options.pagination.scroll?(b=this.scrollParent$,c=this._getDataContainer().first().height()-this.displayPageHeight,b.scrollTop(c+this.scrollDelta)):(d=this.model.getTotalRecords(),d>0&&(a=Math.ceil(d/this.pageSize),this.pageOffset=(a-1)*this.pageSize,this.refresh(!1))),!0)},loadMore:function(){var a=this.model.getTotalRecords();return!this.renderInProgress&&(this.options.pagination.scroll&&!this.scrollPaging?(a<0||this.pageOffset+this.pageCount<a)&&(this.pageOffset+=this.pageCount,this._addPageOfRecords()):this.nextPage(),!0)},gotoPage:function(a){var b,c=this.model.getTotalRecords();return!this.renderInProgress&&(c>0&&(b=Math.ceil(c/this.pageSize),a>=0&&a<b&&(this.pageOffset=a*this.pageSize,this.refresh(!1))),!0)},getActiveRecordId:function(){return this.activeRecordId},getActiveRecord:function(){return this.activeRecord},setActiveRecordValue:function(a){var b=this.columnItems[a];this.activeRecord&&b&&(this.ignoreItemChange=!0,this._setModelValue(null,b.item,this.activeRecord,a,!0),this.ignoreItemChange=!1)},lockActive:function(){this.activeRecord&&(this.activeLockCount+=1)},unlockActive:function(){this.activeRecord&&(this.activeLockCount-=1,this.activeLockCount<0&&(this.activeLockCount=0),0===this.activeLockCount&&(this.activeUnlockCallback&&(this.activeUnlockCallback(),this.activeUnlockCallback=null),this.finishEditingCallback&&(this.finishEditingCallback(),this.finishEditingCallback=null)))},finishEditing:function(){function a(){b._finishEditing?b._finishEditing(c):c.resolve()}var b=this,c=f.Deferred();return this.activeLockCount>0?this.finishEditingCallback=a:a(),c.promise()},addStateIcon:function(b,c,d){var e=a.htmlBuilder();this.stateIconMessages[b]=d,0===this.stateIcons$.find("[data-state='"+b+"']").length&&(e.markup("<span tabindex='0'").attr("class",c).attr("data-state",b).markup("></span>"),this.stateIcons$.append(e.toString()))},removeStateIcon:function(a){this.stateIcons$.find("[data-state='"+a+"']").remove(),delete this.stateIconMessages[a]},_create:function(){var a=this.options;a.hideDeletedRows&&this.element.addClass(r),this.pageOffset=0,this.pageCount=0,this.pageSize=10,this.noData=!0,this.onLastPage=!1,this.lastScrollLeft=null,this.lastScrollTop=null,this.stateIconMessages={},this.reinitCallbacks=null,this.pendingRefresh=null,this.activeRecord=null,this.activeRecordId=null,this.activeLockCount=0,this.activeUnlockCallback=null,this.columnItems=null,this.columnItemsContainer$=null,a.progressOptions||(a.progressOptions={fixed:!a.hasSize}),a.pagination.scroll&&(a.rowsPerPage=null),a.rowsPerPage&&(this.pageSize=a.rowsPerPage)},_tableModelViewDestroy:function(){this.footer$.remove(),this.footer$=null,this.pageRange$=null,this.pageSelector$=null,this.status$=null,this.stateIcons$=null,this.element.removeClass(r),this._scrollHandler&&this.scrollParent$.off("scroll",this._scrollHandler)},_refreshCheckIfVisible:function(){return null===this.element[0].offsetParent?(this.pendingRefresh=!0,!1):(this.pendingRefresh=!1,!0)},_initModel:function(a,c){function d(a,b){var c,d,h,i,j,k,l,m,n,o,p;if(!g.pendingRefresh){if("refresh"===a)g.pageOffset=0,g.pageCount=0,g.refresh();else if("refreshRecords"===a||"revert"===a)for(d=g._elementsFromRecordIds(b.recordIds),c=0;c<d.length;c++)h=d[c],h&&(i=b.records[c],k=b.recordIds[c],j=b.newIds[k]||k,l=g.model.getRecordMetadata(j),g._replaceRecord(h,i,k,j,l));else if("move"===a)for(o=b.records,b.insertAfterId&&(d=g._elementsFromRecordIds([b.insertAfterId]),h=d.length>0?d[0]:null),c=o.length-1;c>=0;c--)i=o[c],j=g.model.getRecordId(i),l=g.model.getRecordMetadata(j),d=g._elementsFromRecordIds([j]),d.length>0&&d[0]&&g._removeRecord(d[0]),m=g._insertRecord(h,i,j,l,h?"after":"before");else if("insert"===a||"copy"===a)if("insert"===a?(p=!1,o=[b.record]):(p=!0,o=b.records),b.insertAfterId&&(d=g._elementsFromRecordIds([b.insertAfterId]),h=d.length>0?d[0]:null),g.noData)setTimeout(function(){g.refresh(),d=g._elementsFromRecordIds([g.model.getRecordId(o[0])]),d.length>0&&d[0]&&g._afterInsert(d,p)},1);else{for(n=[],c=o.length-1;c>=0;c--)i=o[c],j=g.model.getRecordId(i),l=g.model.getRecordMetadata(j),m=g._insertRecord(h,i,j,l,h?"after":"before"),n.push(m);g._afterInsert(n,p)}else if("clearChanges"===a){if(e)for(d=g._elementsFromRecordIds(b.deletedIds),c=0;c<d.length;c++)d[c]&&g._removeRecord(d[c]);for(d=g._elementsFromRecordIds(b.changedIds),c=0;c<d.length;c++)h=d[c],h&&(j=b.changedIds[c],l=g.model.getRecordMetadata(j),i=g.model.getRecord(j),g._updateRecordState(h,j,i,l))}else if(b.recordIds){for(d=g._elementsFromRecordIds(b.recordIds),c=0;c<d.length;c++)h=d[c],h&&(j=b.recordIds[c],l=g.model.getRecordMetadata(j),i=b.records[c],"delete"===a?(!f.hideDeletedRows&&e&&null!==l||g._removeFocus(h),e&&null!==l?g._updateRecordState(h,j,i,l):g._removeRecord(h)):g._updateRecordState(h,j,i,l));"delete"===a&&(0===g.model.getTotalRecords()?g.refresh():f.hideDeletedRows&&(g.element.find(v).removeClass(y).removeAttr(w),g._updateStatus()))}else"set"===a||"metaChange"===a?g.ignoreFieldChange||(i=b.record,j=g.model.getRecordId(i),b.oldIdentity&&g._identityChanged(b.oldIdentity,j),l=g.model.getRecordMetadata(j),d=g._elementsFromRecordIds([j]),d.length>0&&d[0]&&("set"===a&&g._updateRecordField(d[0],i,b.field,l),g._updateRecordState(d[0],j,i,l))):"instanceRename"===a&&g.modelName[1]===b.oldInstance&&(g.modelName[1]=b.newInstance);g._updateTotalRecords()}}var e,f=this.options,g=this;if(this.model&&(this.model.unSubscribe(this.modelViewId),this.modelName!==a&&b.release(this.modelName),this.model=null,this.modelName=null),a){if(this.modelName=a,this.model=b.get(a),!this.model)throw new Error("Model not found: "+a);this.modelViewId=this.model.subscribe({onChange:c||d,progressView:this.element,progressOptions:f.progressOptions}),e=this.model.getOption("onlyMarkForDelete")}},_renderButton:function(a,b,c,d){a.markup("<button class='"+b+"' type='button'").attr("aria-label",d).attr("title",d).markup("><span aria-hidden='true' class='a-Icon ").attr(c).markup("'></span></button>")},_renderAltDataMessages:function(a,b){function c(c,d,e,f){a.markup("<div class='"+c+" "+l+"' style='display:none;'><div class='"+p+"'>").markup("<span aria-hidden='true' class='a-Icon "+e+"'></span>").markup("</div><span class='"+n+"'").optionalAttr("id",b?b+d+"_msg":null).markup(">").markup(f).markup("</span></div>")}c(j,"_no","icon-irr-no-results",this.options.noDataMessage),c(k,"_more","icon-warning",this.options.moreDataMessage)},_renderLoadMore:function(a){var b=this.options;b.pagination.scroll&&b.pagination.loadMore&&!this.scrollPaging&&a.markup("<div class='a-GV-loadMore'><button type='button' class='js-load a-GV-loadMoreButton'>").content(g("LOAD_MORE")).markup("</button></div>")},_renderFooter:function(a,b){function c(){var c=g("PAGE_RANGE");a.markup("<span").optionalAttr("id",b?b+"_pageRange":null).attr("title",c).markup("><span class='u-vh'>").content(c).markup("</span><span class='a-GV-pageRange'></span></span>")}var d,e,f=this.options;f.footer&&(a.markup("<div class='"+q+"'><div class='a-GV-stateIcons'></div><div").optionalAttr("id",b?b+"_status":null).markup(" class='a-GV-status'></div><div class='a-GV-pagination'>"),f.pagination&&(d=!1,e=this.model.getOption("hasTotalRecords"),f.pagination.scroll||(e&&f.pagination.firstAndLastButtons&&this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-first","icon-first",g("FIRST_PAGE")),this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-prev","icon-prev",g("PREV_PAGE"))),e&&(f.pagination.showPageLinks||f.pagination.showPageSelector)?a.markup("<span class='a-GV-pageSelector'></span>"):f.pagination.showRange&&(c(),d=!0),f.pagination.scroll||(this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-next","icon-next",g("NEXT_PAGE")),e&&f.pagination.firstAndLastButtons&&this._renderButton(a,"a-GV-pageButton a-GV-pageButton--nav js-pg-last","icon-last",g("LAST_PAGE"))),!d&&f.pagination.showRange&&c()),a.markup("</div></div>"))},_refreshPagination:function(a){var b=this.options;this.scrollPaging=b.pagination.scroll&&(this.model.getOption("hasTotalRecords")||!b.pagination.loadMore),this.lastScrollTop=0,this.lastScrollLeft=0,a.length&&(b.hasSize||(a=f(b.scrollParentOverride?b.scrollParentOverride:window)),this.lastScrollLeft=a.scrollLeft(),this.lastScrollTop=a.scrollTop())},_paginationHasFocus:function(){var a,b=f(document.activeElement);if(b.closest("."+q).length>0){if(b.parent().hasClass("a-GV-pageSelector-item"))return b.parent().attr("data-value");if(a=/js-pg-\S+/.exec(b.attr("class")))return"."+a[0]}return!1},_restorePaginationFocus:function(a){var b,c;a&&(b=a,b>=0&&(b="[data-value='"+a+"'] button"),c=this.footer$.find(b),c[0]&&c[0].disabled&&(c=this.footer$.find(":focusable").eq(0)),c.focus())},_initPaginationFooter:function(a){var b=this,c=this.options,d=this.element.hasClass("u-RTL")?"right":"left";this.pageKey=null,this.footer$=this.element.find("."+q),this.status$=this.footer$.find(".a-GV-status"),this.stateIcons$=this.footer$.find(".a-GV-stateIcons"),this.pageRange$=this.footer$.find(".a-GV-pageRange"),this.pageSelector$=this.footer$.find(".a-GV-pageSelector"),this.noData$=this.element.find("."+j),this.moreData$=this.element.find("."+k),f.ui.tooltip&&this.stateIcons$.tooltip({content:function(){var a=f(this).attr("data-state");return b.stateIconMessages[a]},items:"[data-state]",show:apex.tooltipManager.defaultShowOption(),tooltipClass:"a-GV-tooltip",position:{my:d+" bottom",at:d+" top-10",collision:"flipfit"}}),c.hasSize?(this.scrollParent$=a,b.scrollPaging&&a.on("scroll.tmv",function(){b._scrollPage()}),this.scrollDelta=0):this._updateScrollHandler(),c.pagination.scroll&&(this.pageOffset=0,this.pageCount=0),!c.hasSize&&c.footer&&c.stickyFooter&&f.apex.stickyWidget&&this.footer$.stickyWidget({isFooter:!0,toggleWidth:!0,stickToEnd:!0,top:function(){return b.element.offset().top+b._getHeaderHeight()}}),c.pagination.showPageLinks?this.pageSelector$.click(function(a){var c=f(a.target).parent();c.length&&b.gotoPage(parseInt(c.attr("data-value"),10)),a.preventDefault()}):c.pagination.showPageSelector&&this.pageSelector$.change(function(a){b.gotoPage(parseInt(f(a.target).val(),10))}),this.footer$.find(".js-pg-first").click(function(){b.firstPage()}),this.footer$.find(".js-pg-prev").click(function(){b.previousPage()}),this.footer$.find(".js-pg-next").click(function(){b.nextPage()}),this.footer$.find(".js-pg-last").click(function(){b.lastPage()}),this.element.find(".js-load").click(function(){b.loadMore()})},_footerHeight:function(){return this.footer$?this.footer$.outerHeight()||0:0},_addPageOfRecords:function(a){function b(){var b,d,i,m,n,o=null,p=j.displayPageHeight/j.displayPageSize;if(j.pageCount=c,0===j.pageOffset&&0===c)j.noData=!0,h.hide(),j.moreData$.hide(),j.noData$.show(),k.autoAddRecord&&j.model.allowAdd()&&j._autoAddRecord();else{if(0===c)return void(k.pagination.scroll||(j.pageOffset-=j.pageSize,j.pageOffset<0&&(j.pageOffset=0),j._addPageOfRecords()));j.noData=!1,j.noData$.hide(),j.model.getDataOverflow()&&k.moreDataMessage?(j.moreData$.show(),h.hide()):(j.moreData$.hide(),h.show()),j.scrollPaging&&j.model.getOption("hasTotalRecords")?(b=g.last().find(t),i=j.model.getTotalRecords(),n=i,0===b.length?(d=j._getDataRenderContext(),j._renderFillerRecord(d,s),b=j._insertFiller(d,null),b.attr(F,0),b.attr(G,i),b=b.last()):0===b.last().next().length&&(n=parseInt(b.last().attr(G),10)),2===g.length&&(o=g.first().find(t)),i!==n&&(b.last().attr(G,i),o&&o.last().attr(G,i)),m=j._getRecordsPerRow(),b.each(function(a){var g,h,i=f(o?[o[a],this]:this),k=!1,n=parseInt(i.last().attr(F),10),q=parseInt(i.last().attr(G),10);if(j.pageOffset<=n?(k=!0,j._insertData(l,e,c,i,"before"),n=j.pageOffset+c):j.pageOffset+c<=q?(d=j._getDataRenderContext(),j._renderFillerRecord(d,s),h=j._insertFiller(d,i),g=Math.floor((j.pageOffset-n)/m)*p,h.attr(F,n),h.attr(G,j.pageOffset-1),h.css("height",g),j.scrollParent$.scrollTop(j.scrollParent$.scrollTop()-j.scrollParent$.height()),k=!0,j._insertData(l,e,c,i,"before"),n=j.pageOffset+c):j.pageOffset+c!==q+1&&a!==b.length-1||(k=!0,j._insertData(l,e,c,i,"after"),q=j.pageOffset-1),k)return n>=q?i.remove():(i.attr(F,n),i.attr(G,q),g=Math.floor((q-n)/m)*p,i.css("height",g)),!1})):j._insertData(l,e,c)}j._updateTotalRecords(),a&&a()}var c,d,e,g,h,j=this,k=this.options,l=this._getDataRenderContext();this.renderInProgress||(h=j.noData$.parent().children().not(m),(this.noData||this.moreData$.is(":visible"))&&(this.noData$.hide(),this.moreData$.hide(),h.show(),this.resize()),g=j._getDataContainer(),0!==this.pageOffset&&k.pagination.scroll||(this.lastControlBreak=null,this.pageFirstOffset="",this.pageLastOffset=""),this.controlBreakCollapsed=!1,k.pagination.scroll&&this.pageLastOffset>=this.pageOffset&&g.find(".a-GV-controlBreak").last().each(function(){j.controlBreakCollapsed=!f(this).hasClass(z)}),c=0,d=this.pageSize,k.pagination.scroll||(this.pageOffset=i(this.pageOffset,this.pageSize)),e=this.pageOffset,this.renderInProgress=!0,this.model.forEachInPage(this.pageOffset,d,function(a,e,f){var g,h,i,j,m;return!k.pagination.scroll&&e>=0&&(e<this.pageOffset||e>=this.pageOffset+d)?(c+=1,void(c!==d&&a||(this.renderInProgress=!1))):(a&&(g=f?this.model.getRecordMetadata(f):{},i=g.serverOffset,this._hasControlBreaks()&&!g.agg&&(h=!0,m=this._controlBreakLabel(a),j=m.label,null===this.lastControlBreak&&(this.lastControlBreak=j,this._renderBreakRecord(l,h,m,i),this.controlBreakCollapsed=!1),g.endControlBreak&&(this.lastControlBreak=null)),this._renderRecord(l,a,e,f,g),void 0!==i&&(i+=1,""===this.pageFirstOffset&&(this.pageFirstOffset=i),this.pageLastOffset=i),c+=1),void(c!==d&&a||(this.renderInProgress=!1,b())))},this))},_initPageSize:function(){var b,c,d,e,g=this.options,h=g.hasSize?this.scrollParent$[0]:document;h||(h=document),b=this._getRecordHeight(),h===document?(c=f(window).height(),this.footer$.hasClass("js-stickyWidget-toggle")&&(c-=this._footerHeight()),e=this._getStickyTop(),e>0&&(c-=e+this._getHeaderHeight())):c=h.offsetHeight,c-=a.getScrollbarSize().height,b<=0&&(b=24),d=Math.floor(c/b),d<1&&(d=1),this.displayPageSize=d,this.displayPageHeight=d*b,d*=this._getRecordsPerRow(),this.options.rowsPerPage||(this.pageSize=g.pagination.scroll?Math.max(40,2*d):d)},_updateStatus:function(){var a,b=this._selectedCount(),c="";this.options.hideDeletedRows&&(a=this._deletedCount()),b>0&&(c+=d.format(this._selectedStatusMessage(),b)),a>0&&(c&&(c+=", "),c+=h("DELETED_COUNT",a)+" "),this.status$.text(c)},_setModelValue:function(a,b,c,d,e){var f,h,i,j,k,l;a&&a.removeClass(x),h=b.getValue(),e||(this.ignoreFieldChange=!0),l=this.model.getRecordId(c),i=this.model.getValue(c,d),null!==i&&"object"==typeof i&&i.hasOwnProperty("v")&&(h={v:h,d:b.displayValueFor(h)}),f=this.model.setValue(c,d,h),"DUP"===f?(this._setColumnItemValue(b,c,d),apex.message.alert(g("DUP_REC_ID"))):(j=b.getValidity(),k=this.model.getRecordId(c),j.valid?this.model.setValidity("valid",k,d):this.model.setValidity("error",k,d,b.getValidationMessage()),k!==l&&this._identityChanged(l,k)),e||(this.ignoreFieldChange=!1)},_initColumnItems:function(a){var b,d,g,h,i,j=!0;for(this.columnItems={},this.columnItemsContainer$=null,b=0;b<a.length;b++)d=a[b],h=d.elementId,i=null,h&&(L[h]?(i=this.columnItems[d.property]=L[h],g=i.item):(g=e(h),g.node&&(j=!1,L[h]=i=this.columnItems[d.property]={element$:f("#"+h).closest(".a-GV-columnItem"),item:g})),i&&!this.columnItemsContainer$&&(this.columnItemsContainer$=i.element$.parent()));this.columnItemsContainer$?j||this.columnItemsContainer$.find(E).addClass(C).attr("tabindex",-1):this.editable&&c.error("An editable "+this.widgetName+" must have at least one column with a column item.")},_activateColumnItem:function(a,b){var c=a.element$;c.find(D).attr("tabindex",0).removeClass(C),c.find(E).first().attr(B,b)},_deactivateColumnItem:function(a,b){var c=a.element$,d=c.find(E);d.first().removeAttr(B),this.columnItemsContainer$.append(c),d.addClass(C).attr("tabindex",-1)},_renderFieldDataValue:function(b,c,d,e,f){var g,h,i,j=null,k=this.options;(f&&f.url||c.linkTargetColumn)&&!e.agg&&(j=c.linkTargetColumn?this.model.getValue(d,c.linkTargetColumn)||null:f.url),g=this.model.getValue(d,c.property),(e.agg||e.inserted&&c.readonly)&&this.model.isIdentityField(c.property)&&(g=""),(c.linkText||c.linkAttributes||c.cellTemplate)&&(h={model:this.model,record:d}),j&&(b.markup("<a").attr("href",j),c.linkAttributes&&b.markup(a.applyTemplate(c.linkAttributes,h)),b.markup(" tabindex='-1'>")),j&&c.linkText?b.markup(a.applyTemplate(c.linkText,h)):c.cellTemplate?e.agg?b.content(""):(g=a.applyTemplate(c.cellTemplate,h),k.highlighter&&(g=k.highlighter(k.highlighterContext,g,c)),b.markup(g)):null!==g&&""!==g||!(k.showNullAs||e.agg||j)?(null===g&&(g=""),"object"==typeof g&&g.hasOwnProperty("d")?g=g.d:(i=this.columnItems[c.property],i&&(g=i.item.displayValueFor(g))),c.escape!==!1&&(g=a.escapeHTML(""+g)),k.highlighter&&(g=k.highlighter(k.highlighterContext,g,c)),b.markup(g)):(g=e.agg||e.inserted||f&&(f.changed||f.error||f.warning)?"":j?j:k.showNullAs,b.content(g)),j&&b.markup("</a>")},_beginSetColumnItems:function(){this.reinitCallbacks=[]},_setColumnItemValue:function(a,b,c,d){var e,f=null,g=this.model.getValue(b,c);null!==g&&"object"==typeof g&&g.hasOwnProperty("d")&&(f=g.d,g=g.v),this.reinitCallbacks?(e=a.reinit(g,f),e&&this.reinitCallbacks.push(e)):a.setValue(g,f),d&&(d.fields&&d.fields[c]&&d.fields[c].disabled?a.disable():a.enable())},_endSetColumnItems:function(){var a,b=this.reinitCallbacks;if(b)for(a=0;a<b.length;a++)b[a]();this.reinitCallbacks=null},_autoAddRecord:function(a){var b=this.model.insertNewRecord(null,a);this.model.getRecordMetadata(b).autoInserted=!0},_triggerBeginEditing:function(a,b){this.element.trigger(J,[{model:this.model,record:a,recordId:b}])},_triggerEndEditing:function(a,b){this.element.trigger(K,[{model:this.model,record:a,recordId:b}])},_updateHighlights:function(){var a,b,c=this.options,d=[],e="";for(a in c.highlights)c.highlights.hasOwnProperty(a)&&(b=c.highlights[a],b.id=a,d.push(b));for(d.sort(function(a,b){return b.seq-a.seq}),a=0;a<d.length;a++)b=d[a],b.cssClass||(b.cssClass=(b.row?"hlr_":"hlc_")+b.id),(b.color||b.background)&&(e+=b.row?"."+b.cssClass+" td":"td."+b.cssClass,e+=" { ",b.color&&(e+="color: "+b.color+" !important; "),b.background&&(e+="background-color: "+b.background+" !important; "),e+="}\n");!this.gridStyles$&&e&&(this.gridStyles$=f("<style type='text/css'></style>"),f("head").append(this.gridStyles$)),this.gridStyles$&&(this.gridStyles$=this.gridStyles$.text(e))},_setOption:function(a,b){var d=this.options;this._super(a,b),"noDataMessage"===a?this.element.find(m+" > "+o).text(b):"rowsPerPage"===a?(d.pagination.scroll&&(d.rowsPerPage=null),d.rowsPerPage&&(this.pageSize=d.rowsPerPage)):"hideDeletedRows"===a?(this.element.toggleClass(r,b),b===!0&&this.element.find(v).removeClass(y).removeAttr(w),this._updateStatus()):"scrollParentOverride"===a&&(d.hasSize?c.warn("Ignoring scrollParentOverride when hasSize is true."):this._updateScrollHandler())},_updateScrollHandler:function(){var a=this,b=this.scrollParent$,c=this.options.scrollParentOverride;this.scrollParent$=f(c?c:window),this.scrollPaging&&(b&&this._scrollHandler?b.off("scroll",this._scrollHandler):this._scrollHandler=function(){a.element[0].clientWidth>0&&a._scrollPage()},this.scrollParent$.on("scroll",this._scrollHandler)),this.scrollDelta=this.element.offset().top-this._getStickyTop()},_scrollPage:function(){var a=this,b=!this.model.getOption("hasTotalRecords"),c=this.scrollParent$.scrollTop();c!==this.lastScrollTop&&(this.lastScrollTop=c,this.scrollPageTimer||(this.scrollPageTimer=setTimeout(function(){var c,d,e,g,h,j,k,l,m=(a.options,a.displayPageHeight/a.displayPageSize);a.scrollPageTimer=null,a.renderInProgress||(j=a.scrollParent$.height(),j=2*j,k=0-j/2,l=k+2*j,b?(d=a._getDataContainer().first(),g=d.height(),e=(a.scrollParent$[0]===window?d.offset().top:d.position().top)-a.scrollParent$.scrollTop(),0-e+1.5*j>g&&(a.pageOffset+=a.pageCount,a._addPageOfRecords())):(c=a._getDataContainer().find(t),c.length||a.scrollParent$.off("scroll.tmv"),h=a.pageOffset,c.each(function(){var b,c,d=f(this),e=d.height(),g=parseInt(d.attr(F),10),n=parseInt(d.attr(G),10);if(g!==n)return c=(a.scrollParent$[0]===window?d.offset().top:d.position().top)-a.scrollParent$.scrollTop(),b=c+e,c<=l&&b>=k?(e<3*j||c+j>l?a.pageOffset=g:b-j<=l?a.pageOffset=i(n,a.pageSize):a.pageOffset=i(g+Math.floor((e-b)/m),a.pageSize),a.pageOffset!==h&&a._addPageOfRecords(),!1):void 0})))},I)))},_updateTotalRecords:function(){var a,b,c,d,e,i,j,k,l=null,m=null,n=this.options,o=n.pagination,p=this.model.getTotalRecords(),q=this.model.getServerTotalRecords();if(p>=0&&(l=Math.ceil(p/this.pageSize),m=Math.floor(this.pageOffset/this.pageSize)),null!==this.lastScrollLeft&&(this.scrollParent$.scrollLeft(this.lastScrollLeft),this.scrollParent$.scrollTop(this.lastScrollTop),this.lastScrollLeft=null,this.lastScrollTop=null),this.onLastPage=!1,0===this.pageCount&&0===this.pageOffset?(d="",this.onLastPage=!0,this.footer$.find(".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last").attr(H,!0)):(this.footer$.find(".js-pg-prev,.js-pg-next,.js-pg-first,.js-pg-last").attr(H,!1),this.element.find(".js-load").attr(H,!1),0===this.pageOffset&&this.footer$.find(".js-pg-prev,.js-pg-first").attr(H,!0),p>0&&m===l-1&&(this.onLastPage=!0,this.footer$.find(".js-pg-next,.js-pg-last").attr(H,!0),this.element.find(".js-load").attr(H,!0)),j=this.model.getOption("hasTotalRecords"),d=this.scrollPaging&&j?h("TOTAL_PAGES",q):j?h("PAGE_RANGE_XYZ",this.pageFirstOffset,this.pageLastOffset,q):h("PAGE_RANGE_XY",this.pageFirstOffset,this.pageLastOffset)),document.activeElement&&document.activeElement.disabled&&f(document.activeElement).hasClass("js-load")&&this.focus(),this.pageRange$.text(d),l>0){if(o.showPageLinks){if(i=p+"_"+this.pageSize+"_"+m,this.pageKey!==i){for(k="<li class='a-GV-pageSelector-item'>&hellip;</li>",this.pageKey=i,e="<ul class='a-GV-pageSelector-list'>",b=m-Math.floor(o.maxLinks/2),b<0&&(b=0),c=b+o.maxLinks,c>=l&&(c=l,b=c-o.maxLinks,b<0&&(b=0)),b>0&&(e+=k),a=b;a<c;a++)e+="<li class='a-GV-pageSelector-item' data-value='"+a+"'><button class='a-GV-pageButton' type='button'>"+(a+1)+"</button></li>";c<l&&(e+=k),e+="</ul>",this.pageSelector$.html(e)}this.pageSelector$.find(A).removeClass(y),this.pageSelector$.find("[data-value="+m+"]").addClass(y)}else if(o.showPageSelector){if(i=p+"_"+this.pageSize,this.pageKey!==i){for(this.pageKey=i,e="<select class='a-GV-pageSelectlist' size='1' aria-label='"+g("PAGE_SELECTION")+"'>",a=0;a<l;a++)e+="<option value='"+a+"'>"+h("SELECT_PAGE_N",a+1)+"</option>";e+="</select>",this.pageSelector$.html(e)}this.pageSelector$.children("select").val(m)}}else this.pageSelector$.empty(),this.pageKey=null},_getHeaderHeight:function(){return 0},_getStickyTop:function(){return 0},_getRecordsPerRow:function(){return 1},_getDataRenderContext:function(){return a.htmlBuilder()},_getDataContainer:function(){return f()},_selectedCount:function(){return 0},_selectedStatusMessage:function(){return d.getMessage(this.options.selectionStatusMessageKey)},_deletedCount:function(){return 0},_hasControlBreaks:function(){return!1},_elementsFromRecordIds:function(a){return[]},_renderFillerRecord:function(a,b){},_insertFiller:function(a,b){return f()},_insertData:function(a,b,c,d,e){},_controlBreakLabel:function(a){return{label:""}},_renderBreakRecord:function(a,b,c,d){a.markup("<h3>").content(c.label).markup("</h3>")},_renderRecord:function(a,b,c,d,e){},_removeRecord:function(a){},_insertRecord:function(a,b,c,d,e){return f()},_afterInsert:function(a,b){},_identityChanged:function(a,b){},_replaceRecord:function(a,b,c,d,e){},_updateRecordField:function(a,b,c,d){},_removeFocus:function(a){},_updateRecordState:function(a,b,c,d){}});var M="a-TMV",N="a-TMV-body",O="a-TMV-w-scroll",P="."+O,Q="is-disabled",R=f.ui.keyCode;f.widget("apex.tableModelView",f.apex.tableModelViewBase,{version:"19.1",widgetEventPrefix:"tableModelView",options:{beforeTemplate:"<ul>",recordTemplate:null,afterTemplate:"</ul>",collectionClasses:null,iconClassColumn:null,imageURLColumn:null,imageAttributes:null,labelColumn:null,linkTarget:!1,linkTargetColumn:null,linkAttributes:null,useIconList:!1,iconListOptions:{},constrainNavigation:!0,selectionChange:null,pageChange:null},_create:function(){var a=this.options,b=this.element;c.info("TabelModelView '"+b[0].id+"' created. Model: "+a.modelName),b.addClass(M),this.rowHeight=null,this.recPerRow=null,this._super(),this._initModel(a.modelName),this._on(this._eventHandlers),this._initRecordTemplate(),this.refresh(),a.disabled&&this._setOption("disabled",a.disabled)},_eventHandlers:{keydown:function(a){var b,c=this.options,d=a.which;c.useIconList&&!a.isDefaultPrevented()&&(b=this.getIconList().options,!b.navigation&&b.noNavKeyContent&&f(a.target).closest(b.noNavKeyContent).length||(d!==R.DOWN&&d!==this.getIconList().forwardKey||!c.pagination.loadMore?(d===R.UP||d===this.getIconList().backwardKey)&&c.pagination.loadMore&&f(a.target).hasClass("js-load")&&(this.getIconList().focus(),a.preventDefault()):this.element.find(".js-load").not(":disabled").focus()[0]&&a.preventDefault(),!c.constrainNavigation||d!==R.DOWN&&d!==R.UP&&d!==R.LEFT&&d!==R.RIGHT&&d!==R.PAGE_UP&&d!==R.PAGE_DOWN||a.preventDefault()))},resize:function(a){a.target===this.element[0]&&(this.resize(),a.stopPropagation())}},_destroy:function(){this._tableModelViewDestroy(),this.element.removeClass(M+" "+Q).empty(),this.data$=null,this._initModel(null)},_setOption:function(a,b){this.options;if(c.info("TabelModelView '"+this.element[0].id+"' set option '"+a+"' to: ",b),"iconListOptions"===a)throw new Error("TabelModelView "+a+" cannot be set. Set options directly on the iconList widget");if(this._super(a,b),"disabled"===a){if(this.element.toggleClass(Q,b),this.options.useIconList)return this.getIconList().option(a,b);b&&this.resize()}else"modelName"===a?(this._initModel(b),this.refresh(!1)):"highlights"===a?this._updateHighlights():"beforeTemplate"===a||"recordTemplate"===a||"afterTemplate"===a||"collectionClasses"===a||"iconClassColumn"===a||"imageURLColumn"===a||"imageAttributes"===a||"labelColumn"===a||"linkTarget"===a||"linkTargetColumn"===a||"linkAttributes"===a?(this._initRecordTemplate(),this.refresh()):"footer"!==a&&"useIconList"!==a&&"pagination"!==a||this.refresh()},refresh:function(a){var b,c=!1,d=this,e=this.element;a!==!0&&(c=this._paginationHasFocus()),void 0===a&&(a=f(document.activeElement).closest(e).length>0),this._refreshCheckIfVisible()&&(this.data$&&(b=this.getSelectedRecords()),this._refreshPagination(e.find(P)),this._initView(),this._updateStatus(),this.resize(),this._addPageOfRecords(function(){c&&(d._restorePaginationFocus(c),a=!1),b&&b.length>0&&d.setSelectedRecords(b,a)}))},resize:function(){var a,b,c,d,e=this.element,g=this.options,h=e.height(),i=e.children().first(),j=e.find(P);if(null!==e[0].offsetParent){if(!i.length||this.pendingRefresh)return void this.refresh();a=e.width(),j.width(a),this.rowHeight=null,this.recPerRow=null,g.hasSize&&(b=h-this._footerHeight(),i.height(b),j.height(b)),g.useIconList&&(this.data$.iconList("resize"),this.scrollPaging&&(c=this._getRecordsPerRow(),d=this._getRecordHeight(),this.data$.find(t).each(function(){var a,b=f(this),e=parseInt(b.last().attr(F),10),g=parseInt(b.last().attr(G),10);a=Math.floor((g-e)/c)*d,b.css("height",a)}))),this._initPageSize()}},focus:function(){var a=this.getIconList();return a?a.focus():void this.data$.find(":focusable").first().focus()},getSelection:function(){var a=this.getIconList();return a?a.getSelection():null},setSelection:function(a,b,c){var d=this.getIconList();if(d)return d.setSelection(a,b,c)},getRecords:function(a){var b,c,d=this,e=[];return a.each(function(){b=f(this).attr("data-id"),b&&(c=d.model.getRecord(b),c&&e.push(c))}),e},getSelectedRecords:function(){return this.options.useIconList&&this.data$?this.getRecords(this.getSelection()):null},setSelectedRecords:function(a,b,c){var d,e=[],g={};if(this.options.useIconList&&this.data$){for(d=0;d<a.length;d++)g[this.model.getRecordId(a[d])]=1;this.data$.children().each(function(){var a=f(this).attr("data-id");g[a]&&e.push(this)}),this.setSelection(f(e),b,c)}},getIconList:function(){return this.options.useIconList&&this.data$?this.data$.data("apex-iconList"):null},_initRecordTemplate:function(){var a,b,c,d,e=/^\s*<[\w]+[^>]*>/,f=this.options;if(!f.recordTemplate){if(f.collectionClasses||(f.collectionClasses="a-TMV-defaultIconView"),!f.labelColumn)throw new Error("Option recordTemplate or labelColumn is required");f.beforeTemplate="<ul>",f.afterTemplate="</ul>",b="<li data-id='&APEX$ROW_ID.' class='&APEX$ROW_STATE_CLASSES.'>",f.linkTarget||f.linkTargetColumn?(d=f.linkTargetColumn?f.linkTargetColumn:"APEX$ROW_URL",b+="<a href='&"+d+".' class='a-IconList-content'"+(f.linkAttributes?" "+f.linkAttributes+" ":"")+">",c="</a>"):(b+="<span class='a-IconList-content'>",c="</span>"),(f.iconClassColumn||f.imageURLColumn)&&(b+="<span class='a-IconList-icon'>",b+=f.iconClassColumn?"<span class='&"+f.iconClassColumn+".'></span>":"<img src='&"+f.imageURLColumn+".'"+(f.imageAttributes?" "+f.imageAttributes+" ":"")+"/>",b+="</span>"),b+="<span class='a-IconList-label'>&"+f.labelColumn+".</span>",b+=c+"</li>",f.recordTemplate=b}a=e.exec(f.recordTemplate),a||(f.beforeTemplate.toLowerCase().match(/<ul|<ol/)?f.recordTemplate="<li>"+f.recordTemplate+"</li>":f.recordTemplate="<div>"+f.recordTemplate+"</div>")},_initView:function(){var a,b=this,c=this.options,d=this._getDataRenderContext();this.recordElement="div",a=/<([^ <>]*)/.exec(c.recordTemplate),a&&a.length>1&&(this.recordElement=a[1].toLowerCase()),d.markup("<div").attr("class",N).markup(">"),this._renderAltDataMessages(d),d.markup("<div").attr("class",O).optionalAttr("tabindex",c.useIconList?"-1":null).markup(">").markup(c.beforeTemplate).markup("<"+this.recordElement+" class='js-data-placeholder' style='display:none;'></"+this.recordElement+">").markup(c.afterTemplate),
this._renderLoadMore(d),d.markup("</div></div>"),this._renderFooter(d),this.element.html(d.toString()),this.data$=this.element.find(".js-data-placeholder").parent(),this.data$.empty().addClass(c.collectionClasses||""),c.useIconList&&(this.data$.iconList(c.iconListOptions),this.data$.on("iconlistselectionchange",function(a){b._updateStatus(),b._trigger("selectionChange",a)})),this._initPaginationFooter(this.element.find(P))},_initRecordMetrics:function(){var a,b=this.options;this.recPerRow=1,a=this.data$.children().filter(":visible").first(),a.length?(b.useIconList&&(this.recPerRow=this.getIconList().getColumns()),this.rowHeight=a.outerHeight()):(a=f(apex.util.applyTemplate(b.recordTemplate,{})),a=this.data$.append(a),b.useIconList&&(this.getIconList().refresh(),this.recPerRow=this.getIconList().getColumns()),this.rowHeight=a.outerHeight(),this.data$.empty())},_getRecordHeight:function(){return this.rowHeight||this._initRecordMetrics(),this.rowHeight},_getRecordsPerRow:function(){return this.recPerRow||this._initRecordMetrics(),this.recPerRow},_getDataContainer:function(){return this.data$},_selectedCount:function(){return this.options.useIconList?this.getIconList().getSelection().length:0},_hasControlBreaks:function(){return!1},_elementsFromRecordIds:function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=this.data$.children("[data-id='"+a[b]+"']"),c[0]&&d.push(c);return d},_renderFillerRecord:function(a,b){a.markup("<"+this.recordElement+" class='"+b+"'></"+this.recordElement+">")},_insertFiller:function(a,b){var c=f(a.toString());return b?b.before(c):this.data$.html(c),c},_insertData:function(a,b,c,d,e){var f,g,h;d?d[e](a.toString()):this.data$.append(a.toString()),this.options.useIconList&&(g=this.element.find(P),h=g.scrollTop(),f=this.getIconList(),f.refresh(),g.scrollTop(h)),this._trigger("pageChange",null,{offset:b,count:c})},_controlBreakLabel:function(a){return{label:""}},_renderBreakRecord:function(a,b,c,d){a.markup("<h3>").content(c.label).markup("</h3>")},_renderRecord:function(a,b,c,d,e){var f,g,h=this.options,i="",j={};e.agg||(j.APEX$ROW_ID=""+d,j.APEX$ROW_INDEX=""+(c+1),e.url&&(j.APEX$ROW_URL=e.url),e.deleted?i+=" "+u:(e.inserted?i+=" is-inserted":e.updated&&(i+=" is-updated"),e.error?i+=" is-error":e.warning&&(i+=" is-warning"),e.highlight&&(f=h.highlights[e.highlight],i+=f&&f.cssClass?" "+f.cssClass:" "+e.highlight)),i&&(j.APEX$ROW_STATE_CLASSES=i),g=apex.util.applyTemplate(this.options.recordTemplate,{extraSubstitutions:j,model:this.model,record:b}),h.highlighter&&(g=h.highlighter(h.highlighterContext,g)),a.markup(g))},_removeRecord:function(a){a.remove()},_insertRecord:function(b,c,d,e,g){var h,i=a.htmlBuilder();return this._renderRecord(i,c,null,d,e),h=f(i.toString()),"after"===g&&b?b.after(h):this.data$.prepend(h),this.options.useIconList&&this.getIconList().refresh(),h},_afterInsert:function(a,b){},_identityChanged:function(a,b){var c,d,e=this._elementsFromRecordIds([a])[0];e&&(c=this.model.getRecord(b),d=this.model.getRecordMetadata(b),this._replaceRecord(e,c,a,b,d))},_replaceRecord:function(b,c,d,e,f){var g,h=a.htmlBuilder();this._renderRecord(h,c,g,e,f),b.replaceWith(h.toString()),this.options.useIconList&&this.getIconList().refresh()},_removeFocus:function(a){},_updateRecordState:function(a,b,c,d){this._replaceRecord(a,c,b,b,d)}})}(apex.util,apex.model,apex.debug,apex.lang,apex.item,apex.jQuery);